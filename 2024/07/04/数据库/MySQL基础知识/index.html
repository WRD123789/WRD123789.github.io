

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=light>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/bg/3.png">
  <link rel="icon" href="/img/bg/3.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Wangrd">
  <meta name="keywords" content="">
  
    <meta name="description" content="MySQL 基础知识 关系型数据库与非关系型数据库 关系型数据库 关系型数据库 (如 MySQL、Oracle、SQLServer) 的特点是:  数据以表格的形式组织, 每个表格由行和列组成, 行代表记录, 列代表字段. 数据之间通过外键建立关系, 支持复杂的数据关系和事务处理. 通常采用结构化查询语言 (SQL) 进行数据查询和操作. 支持 ACID (原子性、一致性、隔离性、持久性) 属性,">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL 基础知识">
<meta property="og:url" content="http://example.com/2024/07/04/%E6%95%B0%E6%8D%AE%E5%BA%93/MySQL%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/index.html">
<meta property="og:site_name" content="Wangrd&#39;s Blog">
<meta property="og:description" content="MySQL 基础知识 关系型数据库与非关系型数据库 关系型数据库 关系型数据库 (如 MySQL、Oracle、SQLServer) 的特点是:  数据以表格的形式组织, 每个表格由行和列组成, 行代表记录, 列代表字段. 数据之间通过外键建立关系, 支持复杂的数据关系和事务处理. 通常采用结构化查询语言 (SQL) 进行数据查询和操作. 支持 ACID (原子性、一致性、隔离性、持久性) 属性,">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/Pictures/20240406205622.png">
<meta property="og:image" content="http://example.com/img/Pictures/20240406210300.png">
<meta property="og:image" content="http://example.com/img/Pictures/20240406210353.png">
<meta property="og:image" content="http://example.com/img/Pictures/20240406210427.png">
<meta property="og:image" content="http://example.com/img/Pictures/20240406210442.png">
<meta property="og:image" content="http://example.com/img/Pictures/20240406210408.png">
<meta property="og:image" content="http://example.com/img/Pictures/20240525101423.png">
<meta property="article:published_time" content="2024-07-04T10:16:59.000Z">
<meta property="article:modified_time" content="2024-07-04T13:37:06.567Z">
<meta property="article:author" content="Wangrd">
<meta property="article:tag" content="数据库">
<meta property="article:tag" content="MySQL">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/img/Pictures/20240406205622.png">
  
  
  
  <title>MySQL 基础知识 - Wangrd&#39;s Blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.7","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Wangrd&#39;s Blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/bg/1.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="MySQL 基础知识"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-07-04 18:16" pubdate>
          2024年7月4日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          8.8k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          74 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">MySQL 基础知识</h1>
            
            
              <div class="markdown-body">
                
                <h1>MySQL 基础知识</h1>
<h2 id="关系型数据库与非关系型数据库">关系型数据库与非关系型数据库</h2>
<h3 id="关系型数据库">关系型数据库</h3>
<p>关系型数据库 (如 MySQL、Oracle、SQLServer) 的特点是:</p>
<ul>
<li>数据以表格的形式组织, 每个表格由行和列组成, 行代表记录, 列代表字段.</li>
<li>数据之间通过外键建立关系, 支持复杂的数据关系和事务处理.</li>
<li>通常采用结构化查询语言 (SQL) 进行数据查询和操作.</li>
<li>支持 ACID (原子性、一致性、隔离性、持久性) 属性, 保证数据的完整性和一致性.</li>
</ul>
<p>关系型数据库的适用场景是:</p>
<ul>
<li>需要严格的数据一致性和事务处理的业务场景, 如金融系统、企业资源规划 (ERP) 等.</li>
<li>数据结构相对稳定, 且需要复杂查询和数据分析的应用场景.</li>
</ul>
<h3 id="非关系型数据库">非关系型数据库</h3>
<p>非关系型数据库 (如 MongoDB、Redis) 的特点是:</p>
<ul>
<li>数据以非结构化或半结构化的形式存储, 例如文档、键值对、图形等.</li>
<li>不需要预先定义表结构, 支持动态的数据模型, 扩展性好, 能够轻松地实现水平扩展, 支持大规模数据存储和处理.</li>
<li>通常采用非 SQL 查询语言, 如 MongoDB 的查询语言、键值数据库的 API 等.</li>
<li>适用于分布式系统和云计算环境, 能够满足高并发、高性能的需求.</li>
</ul>
<p>非关系型数据库的适用场景是:</p>
<ul>
<li>需要处理大规模数据或实时数据的应用场景, 如社交网络、物联网、大数据分析等.</li>
<li>数据结构较为灵活, 需要频繁地进行数据模式调整和迭代的场景.</li>
<li>对事物要求不高, 但读写并发比较大的场景.</li>
<li>对数据的处理操作比较简单的场景.</li>
</ul>
<h2 id="MySQL-端口放行">MySQL 端口放行</h2>
<p>MySQL 端口放行指的是允许网络流量通过服务器上的特定端口与 MySQL 数据库通信. MySQL 默认使用 TCP 协议的 3306 端口进行通信, 因此放行该端口是允许客户端应用程序与 MySQL 服务器进行连接和数据交换的必要步骤.</p>
<p>在网络环境中, 服务器通常会配置防火墙或网络安全策略以限制外部网络流量, 以保护系统安全. 因此, 如果要从远程主机连接到 MySQL 服务器, 必须确保服务器上的 3306 端口被放行, 以允许远程访问.</p>
<p>一般来说, 端口放行的步骤如下:</p>
<ol>
<li><strong>检查防火墙状态</strong>: 首先, 确认服务器上是否启用了防火墙. 如果启用了防火墙, 需要检查防火墙规则, 查看是否已经放行了 3306 端口. <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">查看防火墙是否运行, 这里看到防火墙处于运行状态</span><br>[root@study ~]# systemctl status firewalld<br>● firewalld.service - firewalld - dynamic firewall daemon<br>   Loaded: loaded (/usr/lib/systemd/system/firewalld.service; enabled; vendor preset: enabled)<br>   Active: active (running) since 三 2020-04-15 10:26:27 CST; 2h 50min ago<br>     Docs: man:firewalld(1)<br> Main PID: 1012 (firewalld)<br>   CGroup: /system.slice/firewalld.service<br>           └─1012 /usr/bin/python2 -Es /usr/sbin/firewalld --nofork --nopid<br><br>4月 15 10:26:22 study.centos.mrcode systemd[1]: Starting firewalld - dynamic firewall daemon...<br>4月 15 10:26:27 study.centos.mrcode systemd[1]: Started firewalld - dynamic firewall daemon.<br></code></pre></td></tr></table></figure>
</li>
<li><strong>允许端口通信</strong>: 如果服务器上的防火墙规则不允许 3306 端口通信, 需要添加规则来允许该端口的流量通过. <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">查看开放的端口</span><br>[root@study ~]# firewall-cmd --list-all<br>public (active)<br>  target: default<br>  icmp-block-inversion: no<br>  interfaces: enp0s3 enp0s8<br>  sources:<br>  services: dhcpv6-client ftp http https ssh<br>  ports: 222/tcp 555/tcp			# 这里没有 3306 端口, 说明没有放行该端口<br>  protocols:<br>  masquerade: no<br>  forward-ports:<br>  source-ports:<br>  icmp-blocks:<br>  rich rules:<br>	rule family=&quot;ipv4&quot; source address=&quot;192.168.1.0/24&quot; accept<br><br>// 开放 3306 端口<br>[root@study ~]# firewall-cmd --zone=public --add-port=3306/tcp --permanent<br></code></pre></td></tr></table></figure>
</li>
<li><strong>重新加载防火墙</strong>: 在修改了防火墙规则后, 通常需要重新加载防火墙配置, 以使更改生效. <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">// 重新加载防火墙配置<br>[root@study ~]# firewall-cmd --reload<br></code></pre></td></tr></table></figure>
</li>
<li><strong>测试连接</strong>: 完成端口放行后, 可以从远程主机尝试连接到 MySQL 服务器, 以检查连接是否成功.</li>
</ol>
<h2 id="MySQL-数据类型">MySQL 数据类型</h2>
<h3 id="整数类型">整数类型</h3>
<p>在 MySQL 中, 常见的<strong>整数</strong>类型如下:</p>
<table>
<thead>
<tr>
<th>字段类型</th>
<th>存储空间</th>
<th>取值范围</th>
</tr>
</thead>
<tbody>
<tr>
<td>TINYINT</td>
<td>1 字节</td>
<td>有符号范围是 -128 到 127, 无符号范围是 0 到 255</td>
</tr>
<tr>
<td>SMALLINT</td>
<td>2 字节</td>
<td>有符号范围是 -32768 到 32767, 无符号范围是 0 到 65535</td>
</tr>
<tr>
<td>MEDIUMINT</td>
<td>3 字节</td>
<td>有符号范围是 -8388608 到 8388607, 无符号范围是 0 到 16777215</td>
</tr>
<tr>
<td>INT</td>
<td>4 字节</td>
<td>有符号范围是 -2147483648 到 2147483647, 无符号范围是 0 到 4294967295</td>
</tr>
<tr>
<td>BIGINT</td>
<td>8 字节</td>
<td>有符号范围是 -9223372036854775808 到 9223372036854775807, 无符号范围是 0 到 18446744073709551615</td>
</tr>
</tbody>
</table>
<p>另外, 在声明字段类型时, 可以以 <code>INT(n)</code> 这样的形式来规定显示字符的最小宽度, 当字段中数字的长度小于 n 时, 会在数字前面自动填充空格. 当然, 这种形式不会影响存储范围或数据类型的大小.</p>
<h3 id="浮点数类型">浮点数类型</h3>
<p>在 MySQL 中, 常用的<strong>浮点数</strong>类型如下:</p>
<table>
<thead>
<tr>
<th>字段类型</th>
<th>存储空间</th>
<th>精度</th>
</tr>
</thead>
<tbody>
<tr>
<td>FLOAD</td>
<td>4 字节</td>
<td>约为 7 位</td>
</tr>
<tr>
<td>DOUBLE</td>
<td>8 字节</td>
<td>约为 15 位</td>
</tr>
</tbody>
</table>
<h3 id="定点数类型">定点数类型</h3>
<p>在 MySQL 中, 常用的<strong>定点数</strong> (用于存储精确的十进制数值, 可以指定总共的位数和小数点后的位数) 类型如下:</p>
<table>
<thead>
<tr>
<th>字段类型</th>
<th>存储空间</th>
</tr>
</thead>
<tbody>
<tr>
<td>DECIMAL</td>
<td>每 4 个字节存 9 个数字, 小数点占一个字节</td>
</tr>
</tbody>
</table>
<p>例如, 字段类型声明为 DECIMAL(18, 9), 可以存储值 123456789.987654321, 共占 9 字节.</p>
<h3 id="时间类型">时间类型</h3>
<p>在 MySQL 中, 常用的<strong>时间</strong>类型如下:</p>
<table>
<thead>
<tr>
<th>字段类型</th>
<th>存储空间</th>
<th>格式</th>
<th>范围</th>
</tr>
</thead>
<tbody>
<tr>
<td>DATE</td>
<td>3 字节</td>
<td>YYYY-MM-DD</td>
<td>从 ‘1000-01-01’ 到 ‘9999-12-31’</td>
</tr>
<tr>
<td>TIME</td>
<td>3~6 字节</td>
<td>HH:MM:SS[.微秒值]</td>
<td>从 ‘-838:59:59’ 到 ‘838:59:59’</td>
</tr>
<tr>
<td>YEAR</td>
<td>1 字节</td>
<td>YYYY</td>
<td>从 1901 到 2155</td>
</tr>
<tr>
<td>DATETIME</td>
<td>5~8 字节</td>
<td>YYYY-MM-DD HH:MM:SS[.微秒值]</td>
<td>从 ‘1000-01-01 00:00:00’ 到 ‘9999-12-31 23:59:59’</td>
</tr>
<tr>
<td>TIMESTAMP</td>
<td>4~5 字节</td>
<td>YYYY-MM-DD HH:MM:SS[.微秒值]</td>
<td>从 ‘1970-01-01 00:00:01’ 到 ‘2038-01-19 03:14:07’ UTC</td>
</tr>
</tbody>
</table>
<p>如果想要将字段类型的值精确到微秒级别, 则需要以 <code>TIME(n)</code> 的形式声明字段类型. 指定了微秒精度后, 每 2 位数占用 1 字节. 例如, TIME(2) 相比 TIME 多占用 1 字节, TIME(3) 相比 TIME 多占用 2 字节.</p>
<p>另外, TIMESTAMP 存储的是从 ‘1970-01-01 00:00:00’ UTC 到指定时间的秒数, 在查询结果中会自动转换为当前会话时区的时间, 而 DATETIME 类型存储的日期时间值是一个完整的日期和时间, 不受时区影响, 因此 TIMESTAMP 类型所占用的空间比 DATETIME 小.</p>
<p>TIMESTAMP 相关示例如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 创建一张表</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t_timestamp(dt <span class="hljs-type">TIMESTAMP</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t_timestamp <span class="hljs-keyword">SELECT</span> NOW();<br><br><span class="hljs-comment">-- 查看数据</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> t_timestamp;<br><br>dt<br><span class="hljs-number">2020</span><span class="hljs-number">-04</span><span class="hljs-number">-19</span> <span class="hljs-number">14</span>:<span class="hljs-number">43</span>:<span class="hljs-number">31</span><br><br><span class="hljs-comment">-- 修改时区信息</span><br><span class="hljs-keyword">SET</span> time_zone <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;+10:00&#x27;</span>;<br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> t_timestamp;<br><br>dt<br><span class="hljs-number">2020</span><span class="hljs-number">-04</span><span class="hljs-number">-19</span> <span class="hljs-number">16</span>:<span class="hljs-number">43</span>:<span class="hljs-number">31</span><br><span class="hljs-comment">-- 可以看到修改时区后, 看到的时间就发生变化了</span><br></code></pre></td></tr></table></figure>
<h3 id="字符串类型">字符串类型</h3>
<p>在 MySQL 中, 常用的<strong>字符串</strong>类型如下:</p>
<table>
<thead>
<tr>
<th>类型</th>
<th>范围</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>CHAR(M)</td>
<td>M = 1~255 个字符</td>
<td>固定长度</td>
</tr>
<tr>
<td>VARCHAR(M)</td>
<td>一行中所有 VARCHAR 类型的字段所占用的字节数不能超过 65535 个字节</td>
<td>存储可变长度的 M 个字符</td>
</tr>
<tr>
<td>TINYTEXT</td>
<td>最大长度为 255 个字节</td>
<td>可变长度</td>
</tr>
<tr>
<td>TEXT</td>
<td>最大长度为 65535 个字节</td>
<td>可变长度</td>
</tr>
<tr>
<td>MEDIUMTEXT</td>
<td>最大长度为 16777215 个字节</td>
<td>可变长度</td>
</tr>
<tr>
<td>LONGTEXT</td>
<td>最大长度为 42949667295 个字节</td>
<td>可变长度</td>
</tr>
<tr>
<td>ENUM</td>
<td>值列表最大数目为 65535</td>
<td>只能从一个预定义的值列表中选择一个值, 这个值列表在定义列时指定</td>
</tr>
</tbody>
</table>
<p>需要注意的是, 由于内存临时表不支持 TEXT 类型 (因为 TEXT 类型的字段可能会存储大量的文本数据, 会占用大量的内存空间, 并且 TEXT 类型的字段存储的是变长数据, 会增加内存临时表的数据结构的复杂性), 因此在设计数据库时应尽量避免在需要排序等操作 (这些操作会使用内存临时表来处理数据) 的查询中使用 TEXT 类型字段.</p>
<h2 id="DCL-数据控制语言">DCL (数据控制语言)</h2>
<p>DCL (Data Control Language) 是一种用于管理数据库访问权限和安全性的语言, 它主要用于授权用户对数据库对象的访问权限, 以及管理事务的权限.</p>
<p>详细的介绍可以查看<a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/account-management-statements.html">官方文档</a>, 下面是常用指令的简单介绍.</p>
<h3 id="创建用户">创建用户</h3>
<p>用于<strong>创建数据库用户</strong>的指令如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">USER</span> [IF <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span>]<br>    <span class="hljs-keyword">user</span> [auth_option] [, <span class="hljs-keyword">user</span> [auth_option]] ...<br>    <span class="hljs-keyword">DEFAULT</span> ROLE role [, role ] ...<br>    [REQUIRE &#123;<span class="hljs-keyword">NONE</span> <span class="hljs-operator">|</span> tls_option [[<span class="hljs-keyword">AND</span>] tls_option] ...&#125;]<br>    [<span class="hljs-keyword">WITH</span> resource_option [resource_option] ...]<br>    [password_option <span class="hljs-operator">|</span> lock_option] ...<br>    [COMMENT <span class="hljs-string">&#x27;comment_string&#x27;</span> <span class="hljs-operator">|</span> ATTRIBUTE <span class="hljs-string">&#x27;json_object&#x27;</span>]<br>    <br><span class="hljs-comment">-- 上面的语法中, 有中括号的表示是可选的，</span><br><span class="hljs-comment">-- 其中各个参数的简单介绍如下</span><br><br><span class="hljs-comment">-- 授权选项</span><br>auth_option: &#123;<br>    IDENTIFIED <span class="hljs-keyword">BY</span> <span class="hljs-string">&#x27;auth_string&#x27;</span><br>  <span class="hljs-operator">|</span> IDENTIFIED <span class="hljs-keyword">WITH</span> auth_plugin<br>  <span class="hljs-operator">|</span> IDENTIFIED <span class="hljs-keyword">WITH</span> auth_plugin <span class="hljs-keyword">BY</span> <span class="hljs-string">&#x27;auth_string&#x27;</span><br>  <span class="hljs-operator">|</span> IDENTIFIED <span class="hljs-keyword">WITH</span> auth_plugin <span class="hljs-keyword">AS</span> <span class="hljs-string">&#x27;hash_string&#x27;</span><br>&#125;<br><br><span class="hljs-comment">-- ssl 加密链接配置</span><br>tls_option: &#123;<br>   SSL<br> <span class="hljs-operator">|</span> X509<br> <span class="hljs-operator">|</span> CIPHER <span class="hljs-string">&#x27;cipher&#x27;</span><br> <span class="hljs-operator">|</span> ISSUER <span class="hljs-string">&#x27;issuer&#x27;</span><br> <span class="hljs-operator">|</span> SUBJECT <span class="hljs-string">&#x27;subject&#x27;</span><br>&#125;<br><br><span class="hljs-comment">-- 资源限制</span><br>resource_option: &#123;<br>    MAX_QUERIES_PER_HOUR count		<span class="hljs-comment">-- 该用户每小时查询数量</span><br>  <span class="hljs-operator">|</span> MAX_UPDATES_PER_HOUR count<br>  <span class="hljs-operator">|</span> MAX_CONNECTIONS_PER_HOUR count<br>  <span class="hljs-operator">|</span> MAX_USER_CONNECTIONS count<br>&#125;<br><br>password_option: &#123;<br>    PASSWORD EXPIRE [<span class="hljs-keyword">DEFAULT</span> <span class="hljs-operator">|</span> NEVER <span class="hljs-operator">|</span> <span class="hljs-type">INTERVAL</span> N <span class="hljs-keyword">DAY</span>]  <span class="hljs-comment">-- 密码过期时间</span><br>  <span class="hljs-operator">|</span> PASSWORD HISTORY &#123;<span class="hljs-keyword">DEFAULT</span> <span class="hljs-operator">|</span> N&#125;		<span class="hljs-comment">-- 历史密码重复使用次数</span><br>  <span class="hljs-operator">|</span> PASSWORD REUSE <span class="hljs-type">INTERVAL</span> &#123;<span class="hljs-keyword">DEFAULT</span> <span class="hljs-operator">|</span> N <span class="hljs-keyword">DAY</span>&#125;<br>  <span class="hljs-operator">|</span> PASSWORD REQUIRE <span class="hljs-keyword">CURRENT</span> [<span class="hljs-keyword">DEFAULT</span> <span class="hljs-operator">|</span> OPTIONAL]<br>&#125;<br><br>lock_option: &#123;<br>    ACCOUNT LOCK		<span class="hljs-comment">-- 账户锁定，锁定后无法登录</span><br>  <span class="hljs-operator">|</span> ACCOUNT UNLOCK<br>&#125;<br><br><span class="hljs-comment">-- 还可以通过客户端执行 help 语句查询语法</span><br>mysql<span class="hljs-operator">&gt;</span> help <span class="hljs-keyword">create</span> <span class="hljs-keyword">user</span>;<br></code></pre></td></tr></table></figure>
<p>上述指令的使用示例如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 示例1: 创建一个名为 `mc_class` 的用户,</span><br><span class="hljs-comment">-- 该用户的连接权限限定为从 IP 地址段 `192.168.56.%`,</span><br><span class="hljs-comment">-- 该用户使用 `mysql_native_password` 认证插件, 并使用密码 `1234567` 进行身份验证.</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">USER</span> mc_class@<span class="hljs-string">&#x27;192.168.56.%&#x27;</span> IDENTIFIED <span class="hljs-keyword">WITH</span> <span class="hljs-string">&#x27;mysql_native_password&#x27;</span> <span class="hljs-keyword">by</span> <span class="hljs-string">&#x27;1234567&#x27;</span>;<br><span class="hljs-comment">-- user 由两部分组成 `用户名@访问控制列表`</span><br><span class="hljs-comment">-- 访问控制列表决定用户可以从哪些客户端访问</span><br><span class="hljs-comment">-- @ 后面的 % 号就是通配符, 比如 mysql 里面的 like 语法中的 % </span><br><br><span class="hljs-comment">-- 示例 2: 创建一个测试账户</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">USER</span> mc_test@<span class="hljs-string">&#x27;%&#x27;</span> IDENTIFIED <span class="hljs-keyword">BY</span> <span class="hljs-string">&#x27;123456&#x27;</span><br><span class="hljs-comment">-- 这里没有指定密码插件, 会使用默认的插件</span><br><br><span class="hljs-comment">-- 示例 3: 创建带有资源限制的账户</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">USER</span> mc_test1@<span class="hljs-string">&#x27;%&#x27;</span> IDENTIFIED <span class="hljs-keyword">BY</span> <span class="hljs-string">&#x27;123456&#x27;</span> <span class="hljs-keyword">WITH</span> MAX_USER_CONNECTIONS <span class="hljs-number">1</span>;<br><span class="hljs-comment">-- 这里限制该用户只能建立一个连接</span><br><br><span class="hljs-comment">-- 示例 4：测试上面带资源限制的账户, </span><br><span class="hljs-comment">-- 使用 mysql 客户端连接</span><br>[root<span class="hljs-variable">@study</span> <span class="hljs-operator">~</span>]# mysql <span class="hljs-operator">-</span>u mc_test1  <span class="hljs-operator">-</span>p<br>Enter password: <br><span class="hljs-comment">-- 连接成功一个后，换一个窗口再次连接</span><br>[root<span class="hljs-variable">@study</span> <span class="hljs-operator">~</span>]# mysql <span class="hljs-operator">-</span>u mc_test1  <span class="hljs-operator">-</span>p<br>Enter password: <br>ERROR <span class="hljs-number">1226</span> (<span class="hljs-number">42000</span>): <span class="hljs-keyword">User</span> <span class="hljs-string">&#x27;mc_test1&#x27;</span> has exceeded the <span class="hljs-string">&#x27;max_user_connections&#x27;</span> resource (<span class="hljs-keyword">current</span> <span class="hljs-keyword">value</span>: <span class="hljs-number">1</span>)<br><span class="hljs-comment">-- 可以看到被拒绝了</span><br></code></pre></td></tr></table></figure>
<h3 id="用户授权">用户授权</h3>
<p>MySQL 的常用权限:</p>
<ul>
<li>Insert: 向表中插入数据的权限</li>
<li>Delete: 删除表中数据的权限</li>
<li>update: 修改表中数据的权限</li>
<li>Select: 查询表中数据的权限</li>
<li>Execute: 执行存储过程的权限</li>
</ul>
<p>用于<strong>用户授权</strong>的指令如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">GRANT</span><br>    priv_type [(column_list)]<br>      [, priv_type [(column_list)]] ...  <span class="hljs-comment">-- 权限列表，可以通过 show privileges 获取所有的权限</span><br>    <span class="hljs-keyword">ON</span> [object_type] priv_level		<span class="hljs-comment">-- 在哪个对象中授权</span><br>    <span class="hljs-keyword">TO</span> user_or_role [, user_or_role] ... <span class="hljs-comment">-- 把权限授予哪个用户或角色</span><br>    [<span class="hljs-keyword">WITH</span> <span class="hljs-keyword">GRANT</span> OPTION]<br><br><span class="hljs-keyword">GRANT</span> PROXY <span class="hljs-keyword">ON</span> user_or_role<br>    <span class="hljs-keyword">TO</span> user_or_role [, user_or_role] ...<br>    [<span class="hljs-keyword">WITH</span> <span class="hljs-keyword">GRANT</span> OPTION]<br><br><span class="hljs-keyword">GRANT</span> role [, role] ...<br>    <span class="hljs-keyword">TO</span> user_or_role [, user_or_role] ...<br>    [<span class="hljs-keyword">WITH</span> ADMIN OPTION]<br><br><span class="hljs-comment">-- 其中各个参数的简单介绍如下</span><br><br>object_type: &#123;<br>    <span class="hljs-keyword">TABLE</span><br>  <span class="hljs-operator">|</span> <span class="hljs-keyword">FUNCTION</span><br>  <span class="hljs-operator">|</span> <span class="hljs-keyword">PROCEDURE</span><br>&#125;<br><br>priv_level: &#123;<br>    <span class="hljs-operator">*</span><br>  <span class="hljs-operator">|</span> <span class="hljs-operator">*</span>.<span class="hljs-operator">*</span><br>  <span class="hljs-operator">|</span> db_name.<span class="hljs-operator">*</span><br>  <span class="hljs-operator">|</span> db_name.tbl_name<br>  <span class="hljs-operator">|</span> tbl_name<br>  <span class="hljs-operator">|</span> db_name.routine_name<br>&#125;<br><br>user_or_role: &#123;<br>    <span class="hljs-keyword">user</span><br>  <span class="hljs-operator">|</span> role<br>&#125;<br><br><br></code></pre></td></tr></table></figure>
<p>上述指令的使用示例如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 示例 1: 给用户 mc_test 授权, 只能查询 mysql.user 表中的 user 和 host 列</span><br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">GRANT</span> <span class="hljs-keyword">select</span>(<span class="hljs-keyword">user</span>,host) <span class="hljs-keyword">ON</span> mysql.user <span class="hljs-keyword">TO</span> mc_test@<span class="hljs-string">&#x27;%&#x27;</span>;<br><br><span class="hljs-comment">-- 示例 2: 给用户 mc_test 授权 mysql.user 表的所有列的 select 权限</span><br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">GRANT</span> <span class="hljs-keyword">select</span> <span class="hljs-keyword">ON</span> mysql.user <span class="hljs-keyword">TO</span> mc_test@<span class="hljs-string">&#x27;%&#x27;</span>;<br><span class="hljs-comment">-- 上述设置之后, 用 GUI 程序登录后, 就可以看到 mysql 库中的 user 表, 也能查询到信息了</span><br><br><span class="hljs-comment">-- 可以通过以下语句查看某一个用户授予的权限</span><br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> grants <span class="hljs-keyword">for</span> <span class="hljs-string">&#x27;mc_test&#x27;</span>@<span class="hljs-string">&#x27;%&#x27;</span>;<br><span class="hljs-operator">+</span><span class="hljs-comment">--------------------------------------------------------------------------+</span><br><span class="hljs-operator">|</span> Grants <span class="hljs-keyword">for</span> mc_test@<span class="hljs-operator">%</span>                                                     <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">--------------------------------------------------------------------------+</span><br><span class="hljs-operator">|</span> <span class="hljs-keyword">GRANT</span> USAGE <span class="hljs-keyword">ON</span> <span class="hljs-operator">*</span>.<span class="hljs-operator">*</span> <span class="hljs-keyword">TO</span> `mc_test`@`<span class="hljs-operator">%</span>`                                      <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-keyword">GRANT</span> <span class="hljs-keyword">SELECT</span>, <span class="hljs-keyword">SELECT</span> (`host`, `<span class="hljs-keyword">user</span>`) <span class="hljs-keyword">ON</span> `mysql`.`<span class="hljs-keyword">user</span>` <span class="hljs-keyword">TO</span> `mc_test`@`<span class="hljs-operator">%</span>` <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">--------------------------------------------------------------------------+</span><br><span class="hljs-comment">-- 上面就能看到我赋予的两个 select 权限</span><br><br><span class="hljs-comment">-- 示例 3: 赋予该账户 mysql 库下的所有表的查询权限</span><br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">GRANT</span> <span class="hljs-keyword">select</span> <span class="hljs-keyword">ON</span> mysql.<span class="hljs-operator">*</span> <span class="hljs-keyword">TO</span> mc_test@<span class="hljs-string">&#x27;%&#x27;</span>;<br><br><span class="hljs-comment">-- 示例 4: 同时赋予该账户 select 和 update 权限</span><br><span class="hljs-comment">-- 授予多个权限时使用逗号分隔</span><br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">GRANT</span> <span class="hljs-keyword">select</span>,<span class="hljs-keyword">update</span> <span class="hljs-keyword">ON</span> mysql.<span class="hljs-operator">*</span> <span class="hljs-keyword">TO</span> mc_test@<span class="hljs-string">&#x27;%&#x27;</span>;<br></code></pre></td></tr></table></figure>
<p>另外, 在 MySQL 8.0 之后, 使用 GRANT 授权的数据库用户必须存在, 并且<strong>只有拥有 GRANT OPTION 权限的用户才能使用 GRANT 命令将自己拥有的权限授予其他用户</strong>.</p>
<h3 id="用户权限回收">用户权限回收</h3>
<p>用于回收用户权限的指令如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">REVOKE</span><br>    priv_type [(column_list)]			<span class="hljs-comment">-- 这里与 GRANT 中一致, 只能收回已有的</span><br>      [, priv_type [(column_list)]] ...<br>    <span class="hljs-keyword">ON</span> [object_type] priv_level<br>    <span class="hljs-keyword">FROM</span> user_or_role [, user_or_role] ...<br><br><span class="hljs-keyword">REVOKE</span> <span class="hljs-keyword">ALL</span> [PRIVILEGES], <span class="hljs-keyword">GRANT</span> OPTION<br>    <span class="hljs-keyword">FROM</span> user_or_role [, user_or_role] ...<br><br><span class="hljs-keyword">REVOKE</span> PROXY <span class="hljs-keyword">ON</span> user_or_role<br>    <span class="hljs-keyword">FROM</span> user_or_role [, user_or_role] ...<br><br><span class="hljs-keyword">REVOKE</span> role [, role ] ...<br>    <span class="hljs-keyword">FROM</span> user_or_role [, user_or_role ] ...<br><br>user_or_role: &#123;<br>    <span class="hljs-keyword">user</span><br>  <span class="hljs-operator">|</span> role<br>&#125;<br></code></pre></td></tr></table></figure>
<p>上述指令的使用示例如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 查看该账户拥有的权限</span><br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> grants <span class="hljs-keyword">for</span> <span class="hljs-string">&#x27;mc_test&#x27;</span>@<span class="hljs-string">&#x27;%&#x27;</span>;<br><span class="hljs-operator">+</span><span class="hljs-comment">--------------------------------------------------------------------------+</span><br><span class="hljs-operator">|</span> Grants <span class="hljs-keyword">for</span> mc_test@<span class="hljs-operator">%</span>                                                     <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">--------------------------------------------------------------------------+</span><br><span class="hljs-operator">|</span> <span class="hljs-keyword">GRANT</span> USAGE <span class="hljs-keyword">ON</span> <span class="hljs-operator">*</span>.<span class="hljs-operator">*</span> <span class="hljs-keyword">TO</span> `mc_test`@`<span class="hljs-operator">%</span>`                                      <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-keyword">GRANT</span> <span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">ON</span> `mysql`.<span class="hljs-operator">*</span> <span class="hljs-keyword">TO</span> `mc_test`@`<span class="hljs-operator">%</span>`                               <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-keyword">GRANT</span> <span class="hljs-keyword">SELECT</span>, <span class="hljs-keyword">SELECT</span> (`host`, `<span class="hljs-keyword">user</span>`) <span class="hljs-keyword">ON</span> `mysql`.`<span class="hljs-keyword">user</span>` <span class="hljs-keyword">TO</span> `mc_test`@`<span class="hljs-operator">%</span>` <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">--------------------------------------------------------------------------+</span><br><br><span class="hljs-comment">-- 收回 SELECT (`host`, `user`) 的权限</span><br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">REVOKE</span> <span class="hljs-keyword">SELECT</span>(`host`, `<span class="hljs-keyword">user</span>`) <span class="hljs-keyword">ON</span> mysql.user <span class="hljs-keyword">from</span> mc_test@<span class="hljs-string">&#x27;%&#x27;</span>;<br><span class="hljs-comment">-- 再次查看就发现被收回了</span><br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> grants <span class="hljs-keyword">for</span> <span class="hljs-string">&#x27;mc_test&#x27;</span>@<span class="hljs-string">&#x27;%&#x27;</span>;<br><span class="hljs-operator">+</span><span class="hljs-comment">-------------------------------------------------+</span><br><span class="hljs-operator">|</span> Grants <span class="hljs-keyword">for</span> mc_test@<span class="hljs-operator">%</span>                            <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">-------------------------------------------------+</span><br><span class="hljs-operator">|</span> <span class="hljs-keyword">GRANT</span> USAGE <span class="hljs-keyword">ON</span> <span class="hljs-operator">*</span>.<span class="hljs-operator">*</span> <span class="hljs-keyword">TO</span> `mc_test`@`<span class="hljs-operator">%</span>`             <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-keyword">GRANT</span> <span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">ON</span> `mysql`.<span class="hljs-operator">*</span> <span class="hljs-keyword">TO</span> `mc_test`@`<span class="hljs-operator">%</span>`      <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-keyword">GRANT</span> <span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">ON</span> `mysql`.`<span class="hljs-keyword">user</span>` <span class="hljs-keyword">TO</span> `mc_test`@`<span class="hljs-operator">%</span>` <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">-------------------------------------------------+</span><br></code></pre></td></tr></table></figure>
<p>通过上述示例也可以了解到当用户被授予多个权限时, REVOKE 命令只会撤销指定的权限, 但是不会影响其他权限.</p>
<h2 id="DDL-数据定义语言">DDL (数据定义语言)</h2>
<p>DDL (Data Definition Language) 用于定义数据库中的各种对象, 例如表、视图、索引等. 通过 DDL, 可以创建、修改和删除数据库的结构.</p>
<p>详细的介绍可以查看<a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/sql-data-definition-statements.html">官方文档</a>, 下面是常用指令的简单介绍.</p>
<h3 id="库操作">库操作</h3>
<p>库相关的指令如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 创建数据库</span><br><span class="hljs-keyword">CREATE</span> &#123;DATABASE <span class="hljs-operator">|</span> SCHEMA&#125; [IF <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span>] db_name<br>    [create_specification] ...<br><br>create_specification:<br>    [<span class="hljs-keyword">DEFAULT</span>] <span class="hljs-type">CHARACTER</span> <span class="hljs-keyword">SET</span> [<span class="hljs-operator">=</span>] charset_name			<span class="hljs-comment">-- 字符集</span><br>  <span class="hljs-operator">|</span> [<span class="hljs-keyword">DEFAULT</span>] <span class="hljs-keyword">COLLATE</span> [<span class="hljs-operator">=</span>] collation_name			    <span class="hljs-comment">-- 字符集排序</span><br><br><span class="hljs-comment">-- 修改数据库</span><br><span class="hljs-keyword">ALTER</span> &#123;DATABASE <span class="hljs-operator">|</span> SCHEMA&#125; [db_name]<br>    alter_specification ...<br>    <br>alter_specification:<br>    [<span class="hljs-keyword">DEFAULT</span>] <span class="hljs-type">CHARACTER</span> <span class="hljs-keyword">SET</span> [<span class="hljs-operator">=</span>] charset_name<br>  <span class="hljs-operator">|</span> [<span class="hljs-keyword">DEFAULT</span>] <span class="hljs-keyword">COLLATE</span> [<span class="hljs-operator">=</span>] collation_name<br><br><span class="hljs-comment">-- 删除数据库</span><br><span class="hljs-keyword">DROP</span> &#123;DATABASE <span class="hljs-operator">|</span> SCHEMA&#125; [IF <span class="hljs-keyword">EXISTS</span>] db_name<br><br><span class="hljs-comment">-- 显示已经存在的数据库</span><br><span class="hljs-keyword">SHOW</span> DATABASES;<br><br><span class="hljs-comment">-- 选择数据库</span><br>USE db_name;<br></code></pre></td></tr></table></figure>
<p>上述指令的使用示例如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 示例 1: 创建一个名为 `example`, 指定字符集为 UTF-8 的数据库</span><br><span class="hljs-keyword">CREATE</span> DATABASE example <span class="hljs-type">CHARACTER</span> <span class="hljs-keyword">SET</span> utf8;<br><br><span class="hljs-comment">-- 示例 2: 删除一个名为 `example` 的数据库</span><br><span class="hljs-keyword">DROP</span> DATABASE example;<br><br><span class="hljs-comment">-- 示例 3: 修改一个名为 `example` 的数据库的字符集为 UTF-8</span><br><span class="hljs-keyword">ALTER</span> DATABASE example <span class="hljs-type">CHARACTER</span> <span class="hljs-keyword">SET</span> utf8;<br></code></pre></td></tr></table></figure>
<h3 id="表操作">表操作</h3>
<p>表相关的指令如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 创建表</span><br><span class="hljs-comment">-- TEMPORARY 临时表, 只有当前线程可见, 线程退出时, 表也会随之消失</span><br><span class="hljs-keyword">CREATE</span> [TEMPORARY] <span class="hljs-keyword">TABLE</span> [IF <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span>] tbl_name<br>    (create_definition,...)				<span class="hljs-comment">-- 表定义</span><br>    [table_options]<br>    <br>create_definition:<br>    col_name column_definition		<span class="hljs-comment">-- 列命令和列定义，索引</span><br>  <span class="hljs-operator">|</span> [<span class="hljs-keyword">CONSTRAINT</span> [symbol]] <span class="hljs-keyword">PRIMARY</span> KEY [index_type] (key_part,...)<br>      [index_option] ...<br>  <span class="hljs-operator">|</span> &#123;INDEX<span class="hljs-operator">|</span>KEY&#125; [index_name] [index_type] (key_part,...) <br>      [index_option] ...<br>  <span class="hljs-operator">|</span> [<span class="hljs-keyword">CONSTRAINT</span> [symbol]] <span class="hljs-keyword">UNIQUE</span> [INDEX<span class="hljs-operator">|</span>KEY]<br>      [index_name] [index_type] (key_part,...)<br>      [index_option] ...<br>  <span class="hljs-operator">|</span> &#123;FULLTEXT<span class="hljs-operator">|</span>SPATIAL&#125; [INDEX<span class="hljs-operator">|</span>KEY] [index_name] (key_part,...)<br>      [index_option] ...<br>  <span class="hljs-operator">|</span> [<span class="hljs-keyword">CONSTRAINT</span> [symbol]] <span class="hljs-keyword">FOREIGN</span> KEY<br>      [index_name] (col_name,...) reference_definition<br>  <span class="hljs-operator">|</span> <span class="hljs-keyword">CHECK</span> (expr)<br><br><span class="hljs-comment">-- 列定义</span><br>column_definition:<br>    data_type [<span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-operator">|</span> <span class="hljs-keyword">NULL</span>] [<span class="hljs-keyword">DEFAULT</span> &#123;literal <span class="hljs-operator">|</span> (expr)&#125; ]	<span class="hljs-comment">-- 数据类型</span><br>      [AUTO_INCREMENT] [<span class="hljs-keyword">UNIQUE</span> [KEY]] [[<span class="hljs-keyword">PRIMARY</span>] KEY] <span class="hljs-comment">-- 主键、唯一索引等</span><br>      [COMMENT <span class="hljs-string">&#x27;string&#x27;</span>]		<span class="hljs-comment">-- 备注信息</span><br>      [COLUMN_FORMAT &#123;FIXED<span class="hljs-operator">|</span><span class="hljs-keyword">DYNAMIC</span><span class="hljs-operator">|</span><span class="hljs-keyword">DEFAULT</span>&#125;]<br>      [reference_definition]<br>  <span class="hljs-operator">|</span> data_type [GENERATED ALWAYS] <span class="hljs-keyword">AS</span> (expression)<br>      [VIRTUAL <span class="hljs-operator">|</span> STORED] [<span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-operator">|</span> <span class="hljs-keyword">NULL</span>]<br>      [<span class="hljs-keyword">UNIQUE</span> [KEY]] [[<span class="hljs-keyword">PRIMARY</span>] KEY]<br>      [COMMENT <span class="hljs-string">&#x27;string&#x27;</span>]<br>      <br><span class="hljs-comment">-- 表的选项</span><br>table_option:<br>    AUTO_INCREMENT [<span class="hljs-operator">=</span>] <span class="hljs-keyword">value</span><br>  <span class="hljs-operator">|</span> AVG_ROW_LENGTH [<span class="hljs-operator">=</span>] <span class="hljs-keyword">value</span><br>  <span class="hljs-operator">|</span> [<span class="hljs-keyword">DEFAULT</span>] <span class="hljs-type">CHARACTER</span> <span class="hljs-keyword">SET</span> [<span class="hljs-operator">=</span>] charset_name<br>  <span class="hljs-operator">|</span> CHECKSUM [<span class="hljs-operator">=</span>] &#123;<span class="hljs-number">0</span> <span class="hljs-operator">|</span> <span class="hljs-number">1</span>&#125;<br>  <span class="hljs-operator">|</span> [<span class="hljs-keyword">DEFAULT</span>] <span class="hljs-keyword">COLLATE</span> [<span class="hljs-operator">=</span>] collation_name<br>  <span class="hljs-operator">|</span> COMMENT [<span class="hljs-operator">=</span>] <span class="hljs-string">&#x27;string&#x27;</span><br>  <span class="hljs-operator">|</span> COMPRESSION [<span class="hljs-operator">=</span>] &#123;<span class="hljs-string">&#x27;ZLIB&#x27;</span><span class="hljs-operator">|</span><span class="hljs-string">&#x27;LZ4&#x27;</span><span class="hljs-operator">|</span><span class="hljs-string">&#x27;NONE&#x27;</span>&#125;<br>  <span class="hljs-operator">|</span> CONNECTION [<span class="hljs-operator">=</span>] <span class="hljs-string">&#x27;connect_string&#x27;</span><br>  <span class="hljs-operator">|</span> &#123;DATA<span class="hljs-operator">|</span>INDEX&#125; DIRECTORY [<span class="hljs-operator">=</span>] <span class="hljs-string">&#x27;absolute path to directory&#x27;</span><br>  <span class="hljs-operator">|</span> DELAY_KEY_WRITE [<span class="hljs-operator">=</span>] &#123;<span class="hljs-number">0</span> <span class="hljs-operator">|</span> <span class="hljs-number">1</span>&#125;<br>  <span class="hljs-operator">|</span> ENCRYPTION [<span class="hljs-operator">=</span>] &#123;<span class="hljs-string">&#x27;Y&#x27;</span> <span class="hljs-operator">|</span> <span class="hljs-string">&#x27;N&#x27;</span>&#125;<br>  <span class="hljs-operator">|</span> ENGINE [<span class="hljs-operator">=</span>] engine_name<br>  <span class="hljs-operator">|</span> INSERT_METHOD [<span class="hljs-operator">=</span>] &#123; <span class="hljs-keyword">NO</span> <span class="hljs-operator">|</span> <span class="hljs-keyword">FIRST</span> <span class="hljs-operator">|</span> <span class="hljs-keyword">LAST</span> &#125;<br>  <span class="hljs-operator">|</span> KEY_BLOCK_SIZE [<span class="hljs-operator">=</span>] <span class="hljs-keyword">value</span><br>  <span class="hljs-operator">|</span> MAX_ROWS [<span class="hljs-operator">=</span>] <span class="hljs-keyword">value</span><br>  <span class="hljs-operator">|</span> MIN_ROWS [<span class="hljs-operator">=</span>] <span class="hljs-keyword">value</span><br>  <span class="hljs-operator">|</span> PACK_KEYS [<span class="hljs-operator">=</span>] &#123;<span class="hljs-number">0</span> <span class="hljs-operator">|</span> <span class="hljs-number">1</span> <span class="hljs-operator">|</span> <span class="hljs-keyword">DEFAULT</span>&#125;<br>  <span class="hljs-operator">|</span> PASSWORD [<span class="hljs-operator">=</span>] <span class="hljs-string">&#x27;string&#x27;</span><br>  <span class="hljs-operator">|</span> ROW_FORMAT [<span class="hljs-operator">=</span>] &#123;<span class="hljs-keyword">DEFAULT</span><span class="hljs-operator">|</span><span class="hljs-keyword">DYNAMIC</span><span class="hljs-operator">|</span>FIXED<span class="hljs-operator">|</span>COMPRESSED<span class="hljs-operator">|</span>REDUNDANT<span class="hljs-operator">|</span>COMPACT&#125;<br>  <span class="hljs-operator">|</span> STATS_AUTO_RECALC [<span class="hljs-operator">=</span>] &#123;<span class="hljs-keyword">DEFAULT</span><span class="hljs-operator">|</span><span class="hljs-number">0</span><span class="hljs-operator">|</span><span class="hljs-number">1</span>&#125;<br>  <span class="hljs-operator">|</span> STATS_PERSISTENT [<span class="hljs-operator">=</span>] &#123;<span class="hljs-keyword">DEFAULT</span><span class="hljs-operator">|</span><span class="hljs-number">0</span><span class="hljs-operator">|</span><span class="hljs-number">1</span>&#125;<br>  <span class="hljs-operator">|</span> STATS_SAMPLE_PAGES [<span class="hljs-operator">=</span>] <span class="hljs-keyword">value</span><br>  <span class="hljs-operator">|</span> TABLESPACE tablespace_name<br>  <span class="hljs-operator">|</span> <span class="hljs-keyword">UNION</span> [<span class="hljs-operator">=</span>] (tbl_name[,tbl_name]...)<br><br><span class="hljs-comment">-- 修改表</span><br><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> tbl_name<br>    [alter_specification [, alter_specification] ...]<br>    [partition_options]<br>    <br>alter_specification:<br>    table_options<br>  <span class="hljs-operator">|</span> <span class="hljs-keyword">ADD</span> [<span class="hljs-keyword">COLUMN</span>] col_name column_definition		<span class="hljs-comment">-- 新增一列</span><br>        [<span class="hljs-keyword">FIRST</span> <span class="hljs-operator">|</span> AFTER col_name]		<span class="hljs-comment">-- 指定新列在表中的位置</span><br>  <span class="hljs-operator">|</span> <span class="hljs-keyword">ADD</span> [<span class="hljs-keyword">COLUMN</span>] (col_name column_definition,...)<br>  <span class="hljs-operator">|</span> <span class="hljs-keyword">ADD</span> &#123;INDEX<span class="hljs-operator">|</span>KEY&#125; [index_name]<br>        [index_type] (key_part,...) [index_option] ...<br>  <span class="hljs-operator">|</span> <span class="hljs-keyword">ADD</span> [<span class="hljs-keyword">CONSTRAINT</span> [symbol]] <span class="hljs-keyword">PRIMARY</span> KEY<br>        [index_type] (key_part,...) [index_option] ...<br>  <span class="hljs-operator">|</span> <span class="hljs-keyword">ADD</span> [<span class="hljs-keyword">CONSTRAINT</span> [symbol]]<br>        <span class="hljs-keyword">UNIQUE</span> [INDEX<span class="hljs-operator">|</span>KEY] [index_name]<br>        [index_type] (key_part,...) [index_option] ...<br>  <span class="hljs-operator">|</span> <span class="hljs-keyword">ADD</span> FULLTEXT [INDEX<span class="hljs-operator">|</span>KEY] [index_name]<br>        (key_part,...) [index_option] ...<br>  <span class="hljs-operator">|</span> <span class="hljs-keyword">ADD</span> SPATIAL [INDEX<span class="hljs-operator">|</span>KEY] [index_name]<br>        (key_part,...) [index_option] ...<br>  <span class="hljs-operator">|</span> <span class="hljs-keyword">ADD</span> [<span class="hljs-keyword">CONSTRAINT</span> [symbol]]<br>        <span class="hljs-keyword">FOREIGN</span> KEY [index_name] (col_name,...)<br>        reference_definition<br>  <span class="hljs-operator">|</span> ALGORITHM [<span class="hljs-operator">=</span>] &#123;<span class="hljs-keyword">DEFAULT</span><span class="hljs-operator">|</span>INSTANT<span class="hljs-operator">|</span>INPLACE<span class="hljs-operator">|</span><span class="hljs-keyword">COPY</span>&#125;<br>  <span class="hljs-operator">|</span> <span class="hljs-keyword">ALTER</span> [<span class="hljs-keyword">COLUMN</span>] col_name &#123;<span class="hljs-keyword">SET</span> <span class="hljs-keyword">DEFAULT</span> literal <span class="hljs-operator">|</span> <span class="hljs-keyword">DROP</span> <span class="hljs-keyword">DEFAULT</span>&#125;  <span class="hljs-comment">-- 修改列默认值</span><br>  <span class="hljs-operator">|</span> <span class="hljs-keyword">ALTER</span> INDEX index_name &#123;VISIBLE <span class="hljs-operator">|</span> INVISIBLE&#125;<br>  <span class="hljs-operator">|</span> CHANGE [<span class="hljs-keyword">COLUMN</span>] old_col_name new_col_name column_definition  <span class="hljs-comment">-- 修改列名并修改列定义</span><br>        [<span class="hljs-keyword">FIRST</span><span class="hljs-operator">|</span>AFTER col_name]<br>  <span class="hljs-operator">|</span> [<span class="hljs-keyword">DEFAULT</span>] <span class="hljs-type">CHARACTER</span> <span class="hljs-keyword">SET</span> [<span class="hljs-operator">=</span>] charset_name [<span class="hljs-keyword">COLLATE</span> [<span class="hljs-operator">=</span>] collation_name]<br>  <span class="hljs-operator">|</span> <span class="hljs-keyword">CONVERT</span> <span class="hljs-keyword">TO</span> <span class="hljs-type">CHARACTER</span> <span class="hljs-keyword">SET</span> charset_name [<span class="hljs-keyword">COLLATE</span> collation_name]<br>  <span class="hljs-operator">|</span> &#123;DISABLE<span class="hljs-operator">|</span>ENABLE&#125; KEYS<br>  <span class="hljs-operator">|</span> &#123;DISCARD<span class="hljs-operator">|</span>IMPORT&#125; TABLESPACE<br>  <span class="hljs-operator">|</span> <span class="hljs-keyword">DROP</span> [<span class="hljs-keyword">COLUMN</span>] col_name	<span class="hljs-comment">-- 删除列，数据也会同时被删除</span><br>  <span class="hljs-operator">|</span> <span class="hljs-keyword">DROP</span> &#123;INDEX<span class="hljs-operator">|</span>KEY&#125; index_name<br>  <span class="hljs-operator">|</span> <span class="hljs-keyword">DROP</span> <span class="hljs-keyword">PRIMARY</span> KEY<br>  <span class="hljs-operator">|</span> <span class="hljs-keyword">DROP</span> <span class="hljs-keyword">FOREIGN</span> KEY fk_symbol<br>  <span class="hljs-operator">|</span> FORCE<br>  <span class="hljs-operator">|</span> LOCK [<span class="hljs-operator">=</span>] &#123;<span class="hljs-keyword">DEFAULT</span><span class="hljs-operator">|</span><span class="hljs-keyword">NONE</span><span class="hljs-operator">|</span>SHARED<span class="hljs-operator">|</span>EXCLUSIVE&#125;<br>  <span class="hljs-operator">|</span> MODIFY [<span class="hljs-keyword">COLUMN</span>] col_name column_definition  <span class="hljs-comment">-- 在不修改列名的情况下，修改列的定义</span><br>        [<span class="hljs-keyword">FIRST</span> <span class="hljs-operator">|</span> AFTER col_name]<br>  <span class="hljs-operator">|</span> <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> col_name [, col_name] ...<br>  <span class="hljs-operator">|</span> RENAME <span class="hljs-keyword">COLUMN</span> old_col_name <span class="hljs-keyword">TO</span> new_col_name<br>  <span class="hljs-operator">|</span> RENAME &#123;INDEX<span class="hljs-operator">|</span>KEY&#125; old_index_name <span class="hljs-keyword">TO</span> new_index_name<br>  <span class="hljs-operator">|</span> RENAME [<span class="hljs-keyword">TO</span><span class="hljs-operator">|</span><span class="hljs-keyword">AS</span>] new_tbl_name<br>  <span class="hljs-operator">|</span> &#123;<span class="hljs-keyword">WITHOUT</span><span class="hljs-operator">|</span><span class="hljs-keyword">WITH</span>&#125; VALIDATION<br>  <span class="hljs-operator">|</span> <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">PARTITION</span> (partition_definition)<br>  <span class="hljs-operator">|</span> <span class="hljs-keyword">DROP</span> <span class="hljs-keyword">PARTITION</span> partition_names<br>  <span class="hljs-operator">|</span> DISCARD <span class="hljs-keyword">PARTITION</span> &#123;partition_names <span class="hljs-operator">|</span> <span class="hljs-keyword">ALL</span>&#125; TABLESPACE<br>  <span class="hljs-operator">|</span> IMPORT <span class="hljs-keyword">PARTITION</span> &#123;partition_names <span class="hljs-operator">|</span> <span class="hljs-keyword">ALL</span>&#125; TABLESPACE<br>  <span class="hljs-operator">|</span> <span class="hljs-keyword">TRUNCATE</span> <span class="hljs-keyword">PARTITION</span> &#123;partition_names <span class="hljs-operator">|</span> <span class="hljs-keyword">ALL</span>&#125;<br>  <span class="hljs-operator">|</span> COALESCE <span class="hljs-keyword">PARTITION</span> number<br>  <span class="hljs-operator">|</span> REORGANIZE <span class="hljs-keyword">PARTITION</span> partition_names <span class="hljs-keyword">INTO</span> (partition_definitions)<br>  <span class="hljs-operator">|</span> EXCHANGE <span class="hljs-keyword">PARTITION</span> partition_name <span class="hljs-keyword">WITH</span> <span class="hljs-keyword">TABLE</span> tbl_name [&#123;<span class="hljs-keyword">WITH</span><span class="hljs-operator">|</span><span class="hljs-keyword">WITHOUT</span>&#125; VALIDATION]<br>  <span class="hljs-operator">|</span> ANALYZE <span class="hljs-keyword">PARTITION</span> &#123;partition_names <span class="hljs-operator">|</span> <span class="hljs-keyword">ALL</span>&#125;<br>  <span class="hljs-operator">|</span> <span class="hljs-keyword">CHECK</span> <span class="hljs-keyword">PARTITION</span> &#123;partition_names <span class="hljs-operator">|</span> <span class="hljs-keyword">ALL</span>&#125;<br>  <span class="hljs-operator">|</span> OPTIMIZE <span class="hljs-keyword">PARTITION</span> &#123;partition_names <span class="hljs-operator">|</span> <span class="hljs-keyword">ALL</span>&#125;<br>  <span class="hljs-operator">|</span> REBUILD <span class="hljs-keyword">PARTITION</span> &#123;partition_names <span class="hljs-operator">|</span> <span class="hljs-keyword">ALL</span>&#125;<br>  <span class="hljs-operator">|</span> REPAIR <span class="hljs-keyword">PARTITION</span> &#123;partition_names <span class="hljs-operator">|</span> <span class="hljs-keyword">ALL</span>&#125;<br>  <span class="hljs-operator">|</span> REMOVE PARTITIONING<br>  <span class="hljs-operator">|</span> UPGRADE PARTITIONING<br><br><span class="hljs-comment">-- 删除表</span><br><span class="hljs-keyword">DROP</span> [TEMPORARY] <span class="hljs-keyword">TABLE</span> [IF <span class="hljs-keyword">EXISTS</span>]<br>    tbl_name [, tbl_name] ...   <span class="hljs-comment">-- 可以删除多张表，用逗号分隔</span><br>    [RESTRICT <span class="hljs-operator">|</span> CASCADE]<br><br><span class="hljs-comment">-- 清空表</span><br><span class="hljs-keyword">TRUNCATE</span> <span class="hljs-keyword">TABLE</span> tbl_name;<br><br><span class="hljs-comment">-- 重命名表</span><br>RENAME <span class="hljs-keyword">TABLE</span> old_tbl_name <span class="hljs-keyword">TO</span> new_tbl_name;<br></code></pre></td></tr></table></figure>
<p>上述指令的使用示例如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 示例 1: 创建一个名为 `users` 的表, 包含 `id`、`username` 和 `email` 字段</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> users (<br>    id <span class="hljs-type">INT</span> AUTO_INCREMENT <span class="hljs-keyword">PRIMARY</span> KEY COMMENT <span class="hljs-string">&#x27;用户ID&#x27;</span>,<br>    username <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">50</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">&#x27;用户名&#x27;</span>,<br>    email <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">100</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">&#x27;&#x27;</span> COMMENT <span class="hljs-string">&#x27;邮箱&#x27;</span><br>) COMMENT <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;用户表&#x27;</span>;<br><br><span class="hljs-comment">-- 示例 2: 创建一个名为 `orders` 的表, 包含 `order_id`、`product_id`、`quantity` 和 `customer_id` 字段, 并设置外键约束</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> orders (<br>    order_id <span class="hljs-type">INT</span> AUTO_INCREMENT <span class="hljs-keyword">PRIMARY</span> KEY,<br>    product_id <span class="hljs-type">INT</span>,<br>    quantity <span class="hljs-type">INT</span>,<br>    customer_id <span class="hljs-type">INT</span>,<br>    <span class="hljs-keyword">FOREIGN</span> KEY (customer_id) <span class="hljs-keyword">REFERENCES</span> customers(customer_id)<br>);<br><br><span class="hljs-comment">-- 示例 3: 删除一个名为 `users` 的表</span><br><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> users;<br><br><span class="hljs-comment">-- 示例 4: 向一个名为 `users` 的表中添加一个名为 `birthdate` 的字段</span><br><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> users <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">COLUMN</span> birthdate <span class="hljs-type">DATE</span>;<br><br><span class="hljs-comment">-- 示例 5: 修改一个名为 `orders` 的表, 将 `quantity` 字段的数据类型修改为 DECIMAL(8, 2)</span><br><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> orders MODIFY <span class="hljs-keyword">COLUMN</span> quantity <span class="hljs-type">DECIMAL</span>(<span class="hljs-number">8</span>, <span class="hljs-number">2</span>);<br></code></pre></td></tr></table></figure>
<h3 id="索引维护">索引维护</h3>
<p>索引相关的指令如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 创建索引</span><br><span class="hljs-keyword">CREATE</span> [<span class="hljs-keyword">UNIQUE</span> <span class="hljs-operator">|</span> FULLTEXT <span class="hljs-operator">|</span> SPATIAL] INDEX index_name<br>    [index_type]<br>    <span class="hljs-keyword">ON</span> tbl_name (key_part,...)<br>    [index_option]<br>    [algorithm_option <span class="hljs-operator">|</span> lock_option] ...<br><br>key_part: &#123;col_name [(length)] <span class="hljs-operator">|</span> (expr)&#125; [<span class="hljs-keyword">ASC</span> <span class="hljs-operator">|</span> <span class="hljs-keyword">DESC</span>]<br><br>index_option:<br>    KEY_BLOCK_SIZE [<span class="hljs-operator">=</span>] <span class="hljs-keyword">value</span><br>  <span class="hljs-operator">|</span> index_type<br>  <span class="hljs-operator">|</span> <span class="hljs-keyword">WITH</span> PARSER parser_name<br>  <span class="hljs-operator">|</span> COMMENT <span class="hljs-string">&#x27;string&#x27;</span><br>  <span class="hljs-operator">|</span> &#123;VISIBLE <span class="hljs-operator">|</span> INVISIBLE&#125;<br><br>index_type:<br>    <span class="hljs-keyword">USING</span> &#123;BTREE <span class="hljs-operator">|</span> HASH&#125;<br><br><span class="hljs-comment">-- 删除索引</span><br><span class="hljs-keyword">DROP</span> INDEX index_name <span class="hljs-keyword">ON</span> tbl_name<br>    [algorithm_option <span class="hljs-operator">|</span> lock_option] ...<br></code></pre></td></tr></table></figure>
<p>上述指令的使用示例如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 示例 1: 创建一个唯一索引, 用于确保 `users` 表中的 `email` 字段的唯一性</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">UNIQUE</span> INDEX idx_unique_email <span class="hljs-keyword">ON</span> users (email);<br><br><span class="hljs-comment">-- 示例 2: 创建一个索引, 用于加速 `orders` 表中 `order_date` 字段的查询, 并按照降序排序</span><br><span class="hljs-keyword">CREATE</span> INDEX idx_order_date_desc <span class="hljs-keyword">ON</span> orders (order_date <span class="hljs-keyword">DESC</span>);<br><br><span class="hljs-comment">-- 示例 3: 创建一个前缀索引, 用于加速 `products` 表中 `name` 字段的查询, 只索引字段的前 10 个字符</span><br><span class="hljs-keyword">CREATE</span> INDEX idx_prefix_name <span class="hljs-keyword">ON</span> products (name(<span class="hljs-number">10</span>));<br><br><span class="hljs-comment">-- 示例 4: 创建一个联合索引, 用于加速 `orders` 表中 `user_id` 和 `status` 字段的查询</span><br><span class="hljs-keyword">CREATE</span> INDEX idx_user_id_status <span class="hljs-keyword">ON</span> orders (user_id, status);<br><br><span class="hljs-comment">-- 示例 5: 删除名为 `idx_username` 的索引</span><br><span class="hljs-keyword">DROP</span> INDEX idx_username <span class="hljs-keyword">ON</span> users;<br></code></pre></td></tr></table></figure>
<h2 id="DML-数据操作语言">DML (数据操作语言)</h2>
<p>DML (Data Manipulation Language) 用于在数据库中对数据执行各种操作, 例如查询、插入、更新和删除.</p>
<p>详细的介绍可以查看<a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/sql-data-manipulation-statements.html">官方文档</a>, 下面是常用指令的简单介绍.</p>
<h3 id="插入语句">插入语句</h3>
<p>插入语句的语法如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">INSERT</span> [LOW_PRIORITY <span class="hljs-operator">|</span> DELAYED <span class="hljs-operator">|</span> HIGH_PRIORITY] [IGNORE]<br>    [<span class="hljs-keyword">INTO</span>] tbl_name<br>    [<span class="hljs-keyword">PARTITION</span> (partition_name [, partition_name] ...)]<br>    [(col_name [, col_name] ...)] 		<span class="hljs-comment">-- 列清单</span><br>    &#123;<span class="hljs-keyword">VALUES</span> <span class="hljs-operator">|</span> <span class="hljs-keyword">VALUE</span>&#125; (value_list) [, (value_list)] ...	<span class="hljs-comment">-- 值清单</span><br>    [<span class="hljs-keyword">ON</span> DUPLICATE KEY <span class="hljs-keyword">UPDATE</span> assignment_list] <span class="hljs-comment">-- 当出现主键或唯一索引冲突事件的行为，比如更新旧数据</span><br><br><span class="hljs-keyword">INSERT</span> [LOW_PRIORITY <span class="hljs-operator">|</span> DELAYED <span class="hljs-operator">|</span> HIGH_PRIORITY] [IGNORE]<br>    [<span class="hljs-keyword">INTO</span>] tbl_name<br>    [<span class="hljs-keyword">PARTITION</span> (partition_name [, partition_name] ...)]<br>    <span class="hljs-keyword">SET</span> assignment_list<br>    [<span class="hljs-keyword">ON</span> DUPLICATE KEY <span class="hljs-keyword">UPDATE</span> assignment_list]<br><br><span class="hljs-keyword">INSERT</span> [LOW_PRIORITY <span class="hljs-operator">|</span> HIGH_PRIORITY] [IGNORE]<br>    [<span class="hljs-keyword">INTO</span>] tbl_name<br>    [<span class="hljs-keyword">PARTITION</span> (partition_name [, partition_name] ...)]<br>    [(col_name [, col_name] ...)]<br>    <span class="hljs-keyword">SELECT</span> ...<br>    [<span class="hljs-keyword">ON</span> DUPLICATE KEY <span class="hljs-keyword">UPDATE</span> assignment_list]<br><br><span class="hljs-keyword">value</span>:<br>    &#123;expr <span class="hljs-operator">|</span> <span class="hljs-keyword">DEFAULT</span>&#125;<br><br>value_list:<br>    <span class="hljs-keyword">value</span> [, <span class="hljs-keyword">value</span>] ...<br><br>assignment:<br>    col_name <span class="hljs-operator">=</span> <span class="hljs-keyword">value</span><br><br>assignment_list:<br>    assignment [, assignment] ...<br></code></pre></td></tr></table></figure>
<p>上述指令的使用示例如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 示例 1: 插入多条用户数据到 `users` 表中</span><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> users (username, email, password) <span class="hljs-keyword">VALUES</span><br>(<span class="hljs-string">&#x27;john_doe&#x27;</span>, <span class="hljs-string">&#x27;john@example.com&#x27;</span>, <span class="hljs-string">&#x27;password123&#x27;</span>),<br>(<span class="hljs-string">&#x27;jane_smith&#x27;</span>, <span class="hljs-string">&#x27;jane@example.com&#x27;</span>, <span class="hljs-string">&#x27;password456&#x27;</span>),<br>(<span class="hljs-string">&#x27;alice_wang&#x27;</span>, <span class="hljs-string">&#x27;alice@example.com&#x27;</span>, <span class="hljs-string">&#x27;password789&#x27;</span>);<br><br><span class="hljs-comment">-- 示例 2: 将 SELECT 查询语句的结果插入数据到 `new_users` 表中</span><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> new_users (username, email, password)<br><span class="hljs-keyword">SELECT</span> username, email, <span class="hljs-string">&#x27;default_password&#x27;</span> <span class="hljs-keyword">FROM</span> users <span class="hljs-keyword">WHERE</span> status <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;active&#x27;</span>;<br><br><span class="hljs-comment">-- 示例 3: 插入数据到 `users` 表中, 如果插入的数据违反了唯一性约束, 则忽略该行</span><br><span class="hljs-keyword">INSERT</span> IGNORE <span class="hljs-keyword">INTO</span> users (username, email) <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">&#x27;john_doe&#x27;</span>, <span class="hljs-string">&#x27;john@example.com&#x27;</span>);<br><br><span class="hljs-comment">-- 示例 4: 如果插入的数据违反了唯一性约束, 则更新对应的记录</span><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> users (username, email) <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">&#x27;john_doe&#x27;</span>, <span class="hljs-string">&#x27;john@example.com&#x27;</span>)<br><span class="hljs-keyword">ON</span> DUPLICATE KEY <span class="hljs-keyword">UPDATE</span> email <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;john@example.com&#x27;</span>;<br></code></pre></td></tr></table></figure>
<h3 id="查询语句">查询语句</h3>
<p>查询语句的语法如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span>  <span class="hljs-comment">-- SELECT 是唯一必选的</span><br>    [<span class="hljs-keyword">ALL</span> <span class="hljs-operator">|</span> <span class="hljs-keyword">DISTINCT</span> <span class="hljs-operator">|</span> DISTINCTROW ]<br>      [HIGH_PRIORITY]<br>      [STRAIGHT_JOIN]<br>      [SQL_SMALL_RESULT] [SQL_BIG_RESULT] [SQL_BUFFER_RESULT]<br>      SQL_NO_CACHE [SQL_CALC_FOUND_ROWS]<br>    select_expr [, select_expr ...] <span class="hljs-comment">-- 列或表达式</span><br>    [<span class="hljs-keyword">FROM</span> table_references<br>      [<span class="hljs-keyword">PARTITION</span> partition_list]<br>    [<span class="hljs-keyword">WHERE</span> where_condition]<br>    [<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> &#123;col_name <span class="hljs-operator">|</span> expr <span class="hljs-operator">|</span> position&#125;, ... [<span class="hljs-keyword">WITH</span> <span class="hljs-keyword">ROLLUP</span>]]<br>    [<span class="hljs-keyword">HAVING</span> where_condition]<br>    [<span class="hljs-keyword">WINDOW</span> window_name <span class="hljs-keyword">AS</span> (window_spec)<br>        [, window_name <span class="hljs-keyword">AS</span> (window_spec)] ...]<br>    [<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> &#123;col_name <span class="hljs-operator">|</span> expr <span class="hljs-operator">|</span> position&#125;<br>      [<span class="hljs-keyword">ASC</span> <span class="hljs-operator">|</span> <span class="hljs-keyword">DESC</span>], ... [<span class="hljs-keyword">WITH</span> <span class="hljs-keyword">ROLLUP</span>]]<br>    [LIMIT &#123;[<span class="hljs-keyword">offset</span>,] row_count <span class="hljs-operator">|</span> row_count <span class="hljs-keyword">OFFSET</span> <span class="hljs-keyword">offset</span>&#125;]<br>    [<span class="hljs-keyword">INTO</span> OUTFILE <span class="hljs-string">&#x27;file_name&#x27;</span><br>        [<span class="hljs-type">CHARACTER</span> <span class="hljs-keyword">SET</span> charset_name]<br>        export_options<br>      <span class="hljs-operator">|</span> <span class="hljs-keyword">INTO</span> DUMPFILE <span class="hljs-string">&#x27;file_name&#x27;</span><br>      <span class="hljs-operator">|</span> <span class="hljs-keyword">INTO</span> var_name [, var_name]]<br>    [<span class="hljs-keyword">FOR</span> &#123;<span class="hljs-keyword">UPDATE</span> <span class="hljs-operator">|</span> SHARE&#125; [<span class="hljs-keyword">OF</span> tbl_name [, tbl_name] ...] [NOWAIT <span class="hljs-operator">|</span> <span class="hljs-keyword">SKIP</span> LOCKED] <br>      <span class="hljs-operator">|</span> LOCK <span class="hljs-keyword">IN</span> SHARE MODE]]<br></code></pre></td></tr></table></figure>
<p>上述指令的使用示例如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 示例 1: 查询订单表中的订单信息, 并关联用户表和产品表, 获取订单对应的用户和产品信息</span><br><span class="hljs-keyword">SELECT</span> orders.order_id, users.username, products.product_name<br><span class="hljs-keyword">FROM</span> orders<br><span class="hljs-keyword">JOIN</span> users <span class="hljs-keyword">ON</span> orders.user_id <span class="hljs-operator">=</span> users.user_id<br><span class="hljs-keyword">JOIN</span> products <span class="hljs-keyword">ON</span> orders.product_id <span class="hljs-operator">=</span> products.product_id;<br><br><span class="hljs-comment">-- 示例 2: 查询每个用户的订单数量, 并按订单数量降序排序</span><br><span class="hljs-keyword">SELECT</span> user_id, <span class="hljs-built_in">COUNT</span>(order_id) <span class="hljs-keyword">AS</span> order_count<br><span class="hljs-keyword">FROM</span> orders<br><span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> user_id<br><span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> order_count <span class="hljs-keyword">DESC</span>;<br><br><span class="hljs-comment">-- 示例 3: 查询购买日期在某个范围内的订单信息, 并按订单金额降序排序</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span><br><span class="hljs-keyword">FROM</span> orders<br><span class="hljs-keyword">WHERE</span> purchase_date <span class="hljs-keyword">BETWEEN</span> <span class="hljs-string">&#x27;2023-01-01&#x27;</span> <span class="hljs-keyword">AND</span> <span class="hljs-string">&#x27;2023-12-31&#x27;</span><br><span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> total_amount <span class="hljs-keyword">DESC</span>;<br><br><span class="hljs-comment">-- 示例 4: 查询用户和订单信息, 满足用户 ID 在某个范围内且订单金额大于某个值的条件</span><br><span class="hljs-keyword">SELECT</span> users.username, orders.order_id, orders.total_amount<br><span class="hljs-keyword">FROM</span> users<br><span class="hljs-keyword">JOIN</span> orders <span class="hljs-keyword">ON</span> users.user_id <span class="hljs-operator">=</span> orders.user_id<br><span class="hljs-keyword">WHERE</span> users.user_id <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">100</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">200</span><br><span class="hljs-keyword">AND</span> orders.total_amount <span class="hljs-operator">&gt;</span> <span class="hljs-number">1000</span>;<br><br><span class="hljs-comment">-- 示例 5: 查询用户的等级, 根据用户的订单总金额判断用户等级</span><br><span class="hljs-keyword">SELECT</span> user_id,<br>       <span class="hljs-keyword">CASE</span><br>           <span class="hljs-keyword">WHEN</span> total_amount <span class="hljs-operator">&gt;=</span> <span class="hljs-number">1000</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">&#x27;Platinum&#x27;</span><br>           <span class="hljs-keyword">WHEN</span> total_amount <span class="hljs-operator">&gt;=</span> <span class="hljs-number">500</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">&#x27;Gold&#x27;</span><br>           <span class="hljs-keyword">ELSE</span> <span class="hljs-string">&#x27;Silver&#x27;</span><br>       <span class="hljs-keyword">END</span> <span class="hljs-keyword">AS</span> user_level<br><span class="hljs-keyword">FROM</span> orders;<br><br><span class="hljs-comment">-- 示例 6: 查询所有员工和客户的姓名, 并将结果合并为一个列表</span><br><span class="hljs-comment">-- `UNION` 对结果进行合并时会自动去除重复的行.</span><br><span class="hljs-comment">-- `UNION ALL` 不进行重复行的去除, 直接将所有查询结果按照顺序合并到一起.</span><br><span class="hljs-keyword">SELECT</span> employee_name <span class="hljs-keyword">AS</span> name <span class="hljs-keyword">FROM</span> employees<br><span class="hljs-keyword">UNION</span><br><span class="hljs-keyword">SELECT</span> customer_name <span class="hljs-keyword">AS</span> name <span class="hljs-keyword">FROM</span> customers;<br><br><span class="hljs-comment">-- 示例 7: 返回表中从第 6 行开始的 4 行记录</span><br><span class="hljs-comment">-- LIMIT offset, row_count;</span><br><span class="hljs-comment">-- `offset` 表示偏移量, 决定了结果集的起始位置. 如果省略 `offset`, 则默认从第一行开始</span><br><span class="hljs-comment">-- `row_count` 指定了返回结果的行数, 即最多返回多少行. 如果省略 `row_count`, 则返回所有匹配的行.</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> table_name LIMIT <span class="hljs-number">4</span> <span class="hljs-keyword">OFFSET</span> <span class="hljs-number">5</span>;<br><span class="hljs-comment">-- 或</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> table_name LIMIT <span class="hljs-number">5</span>, <span class="hljs-number">4</span>;<br></code></pre></td></tr></table></figure>
<h3 id="删除语句">删除语句</h3>
<p>删除语句的语法如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">DELETE</span> [LOW_PRIORITY] [QUICK] [IGNORE] <span class="hljs-keyword">FROM</span> tbl_name<br>    [<span class="hljs-keyword">PARTITION</span> (partition_name [, partition_name] ...)]<br>    [<span class="hljs-keyword">WHERE</span> where_condition]<br>    [<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> ...]<br>    [LIMIT row_count]<br></code></pre></td></tr></table></figure>
<p>上述指令的使用示例如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 示例 1: 删除表中重复的行</span><br><span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> table_name <br><span class="hljs-keyword">WHERE</span> rowid <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">IN</span> (<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">MIN</span>(rowid) <br>					<span class="hljs-keyword">FROM</span> table_name <br>					<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> column1, column2, ...);<br><br><span class="hljs-comment">-- 示例 2: 使用子查询删除跨表中的数据</span><br><span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> table_name <br><span class="hljs-keyword">WHERE</span> column1 <span class="hljs-keyword">IN</span> (<span class="hljs-keyword">SELECT</span> column1 <br>				  <span class="hljs-keyword">FROM</span> other_table <br>				  <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">condition</span>);<br><br><span class="hljs-comment">-- 示例 3: 删除表并使用 CASCADE 删除相关联的外键数据</span><br><span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> table_name CASCADE;<br></code></pre></td></tr></table></figure>
<h3 id="修改语句">修改语句</h3>
<p>修改语句的语法如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">UPDATE</span> [LOW_PRIORITY] [IGNORE] table_reference<br>    <span class="hljs-keyword">SET</span> assignment_list<br>    [<span class="hljs-keyword">WHERE</span> where_condition]  <span class="hljs-comment">-- 过滤出需要修改的数据</span><br>    [<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> ...]<br>    [LIMIT row_count]<br><br><span class="hljs-keyword">value</span>:<br>    &#123;expr <span class="hljs-operator">|</span> <span class="hljs-keyword">DEFAULT</span>&#125;<br><br>assignment:<br>    col_name <span class="hljs-operator">=</span> <span class="hljs-keyword">value</span><br><br>assignment_list:<br>    assignment [, assignment] ...<br></code></pre></td></tr></table></figure>
<p>上述指令的使用示例如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 示例 1: 更新具有特定条件的行</span><br><span class="hljs-keyword">UPDATE</span> table_name <br><span class="hljs-keyword">SET</span> column1 <span class="hljs-operator">=</span> value1, column2 <span class="hljs-operator">=</span> value2 <br><span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">condition</span>;<br><br><span class="hljs-comment">-- 示例 2: 批量更新数据</span><br><span class="hljs-keyword">UPDATE</span> orders <br><span class="hljs-keyword">SET</span> status <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;completed&#x27;</span> <br><span class="hljs-keyword">WHERE</span> status <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;pending&#x27;</span> <br>LIMIT <span class="hljs-number">100</span>;<br></code></pre></td></tr></table></figure>
<h3 id="比较运算符">比较运算符</h3>
<p>MySQL 中的比较运算符如下:</p>
<ul>
<li><code>=</code>、<code>&gt;</code>、<code>&lt;</code>、<code>&gt;=</code>、<code>&lt;=</code>、<code>&lt;&gt;</code>、<code>!+</code>, 其中 <code>&lt;&gt;</code> 和 <code>-=</code> 都表示不等于.</li>
<li><code>BETWEEN min AND max</code>, 筛选中的列值大于等于 min, 小于等于 max.</li>
<li><code>IS NULL</code>、<code>IS NOT NULL</code>: 判断列的值是否为 NULL.</li>
<li><code>LIKE</code>、<code>NOT LIKE</code>. <code>%</code> 通配符表示匹配任意长度的字符 (包括零个字符), <code>_</code> 通配符表示匹配单个字符.</li>
<li><code>IN</code>、<code>NOT IN</code>: 判断列的值是否在指定的值列表中.</li>
</ul>
<h3 id="逻辑运算符">逻辑运算符</h3>
<p>MySQL 中的逻辑运算符如下:</p>
<ul>
<li><code>AND</code>、<code>&amp;&amp;</code>:  AND 运算符两边的表达式都为真时, 返回的结果才为真.</li>
<li><code>OR</code>、<code>||</code>: OR 运算符两边的表达式有一条为真时, 返回结果就为真.</li>
<li><code>XOR</code>: 只有一真一假时才返回真.</li>
</ul>
<p>需要注意的是, 任何运算符和 NULL 值运算结果都为 NULL.</p>
<h3 id="连接">连接</h3>
<p>MySQL 中常用的连接方式如下:</p>
<table>
<thead>
<tr>
<th>图</th>
<th>连接方式</th>
<th>说明</th>
<th>SQL 语句</th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="/img/Pictures/20240406205622.png" srcset="/img/loading.gif" lazyload alt=""></td>
<td>内连接</td>
<td>共有部分</td>
<td><code>SELECT * FROM tableA INNER JOIN tableB ON tableA.column = tableB.column;</code></td>
</tr>
<tr>
<td><img src="/img/Pictures/20240406210300.png" srcset="/img/loading.gif" lazyload alt=""></td>
<td>左连接</td>
<td>A 表独有 + 共有部分</td>
<td><code>SELECT * FROM tableA LEFT JOIN tableB ON tableA.column = tableB.column;</code></td>
</tr>
<tr>
<td><img src="/img/Pictures/20240406210353.png" srcset="/img/loading.gif" lazyload alt=""></td>
<td>右连接</td>
<td>B 表独有 + 共有部分</td>
<td><code>SELECT * FROM tableA RIGHT JOIN tableB ON tableA.column = tableB.column;</code></td>
</tr>
<tr>
<td><img src="/img/Pictures/20240406210427.png" srcset="/img/loading.gif" lazyload alt=""></td>
<td>无</td>
<td>A 表独有</td>
<td><code>SELECT * FROM tableA LEFT JOIN tableB ON tableA.column = tableB.column WHERE tableB.column IS NULL</code></td>
</tr>
<tr>
<td><img src="/img/Pictures/20240406210442.png" srcset="/img/loading.gif" lazyload alt=""></td>
<td>无</td>
<td>B 表独有</td>
<td><code>SELECT * FROM tableA RIGHT JOIN tableB ON tableA.column = tableB.column WHERE tableA.column IS NULL</code></td>
</tr>
<tr>
<td><img src="/img/Pictures/20240406210408.png" srcset="/img/loading.gif" lazyload alt=""></td>
<td>全连接</td>
<td>A 表独有 + 共有部分 + B 表独有</td>
<td><code>SELECT * FROM tableA FULL JOIN tableB ON tableA.column = tableB.column;</code></td>
</tr>
</tbody>
</table>
<p>在连接时, 如果一个表中没有匹配的行, 则会用 NULL 值填充.</p>
<h3 id="分组">分组</h3>
<p>分组 (GROUP BY) 是一种将数据行分组并对每个组应用聚合函数的操作, 可以通过 HAVING 对分组后的数据进行过滤, 而 WHERE 语句只能用在分组前.</p>
<p>分组的语法如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> column1, column2, ..., aggregate_function(column_name)<br><span class="hljs-keyword">FROM</span> table_name<br><span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> column1, column2, ...;<br></code></pre></td></tr></table></figure>
<p>该指令的使用示例如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 示例: 查询各个难度的课程的数量</span><br><span class="hljs-keyword">SELECT</span><br>	b.level_name,  <span class="hljs-comment">-- 分组键可以出现在 SELECT 语句中, 非分组键则不能</span><br>	<span class="hljs-built_in">count</span>( <span class="hljs-operator">*</span> )<br><span class="hljs-keyword">FROM</span><br>	imc_course a<br>	<span class="hljs-keyword">JOIN</span> imc_level b <span class="hljs-keyword">ON</span> a.level_id <span class="hljs-operator">=</span> b.level_id <br><span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span><br>	b.level_name <br>	<br><span class="hljs-comment">-- 查询响应数据	</span><br>level_name	<span class="hljs-built_in">count</span>( <span class="hljs-operator">*</span> )<br>入门	<span class="hljs-number">22</span><br>初级	<span class="hljs-number">28</span><br>高级	<span class="hljs-number">24</span><br>中级	<span class="hljs-number">27</span><br></code></pre></td></tr></table></figure>
<h3 id="常用聚合函数">常用聚合函数</h3>
<p>MySQL 中常用的聚合函数如下:</p>
<table>
<thead>
<tr>
<th>聚合函数</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>COUNT()</td>
<td>计算行数或满足条件的行数</td>
</tr>
<tr>
<td>SUM()</td>
<td>计算数值列的总和</td>
</tr>
<tr>
<td>AVG()</td>
<td>计算数值列的平均值</td>
</tr>
<tr>
<td>MAX()</td>
<td>返回数值列中的最大值</td>
</tr>
<tr>
<td>MIN()</td>
<td>返回数值列中的最小值</td>
</tr>
</tbody>
</table>
<h3 id="视图">视图</h3>
<p>在 MySQL 中, 视图 (View) 是虚拟的表, 它的数据是根据创建视图时指定的查询语句来动态生成的, 不存储实际的数据. 视图可以简化复杂的查询, 将查询逻辑封装起来, 提高查询的复用性和安全性 (通过视图可以隐藏表中的部分列或行, 对敏感信息进行保护).</p>
<p>视图相关的语法如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 创建视图</span><br><span class="hljs-keyword">CREATE</span><br>    [<span class="hljs-keyword">OR</span> REPLACE]<br>    [ALGORITHM <span class="hljs-operator">=</span> &#123;UNDEFINED <span class="hljs-operator">|</span> <span class="hljs-keyword">MERGE</span> <span class="hljs-operator">|</span> TEMPTABLE&#125;]<br>    [DEFINER <span class="hljs-operator">=</span> <span class="hljs-keyword">user</span>]<br>    [<span class="hljs-keyword">SQL</span> SECURITY &#123; DEFINER <span class="hljs-operator">|</span> INVOKER &#125;]<br>    <span class="hljs-keyword">VIEW</span> view_name [(column_list)]<br>    <span class="hljs-keyword">AS</span> select_statement<br>    [<span class="hljs-keyword">WITH</span> [<span class="hljs-keyword">CASCADED</span> <span class="hljs-operator">|</span> <span class="hljs-keyword">LOCAL</span>] <span class="hljs-keyword">CHECK</span> OPTION]<br></code></pre></td></tr></table></figure>
<p>视图的使用示例如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 创建视图</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">VIEW</span> view_name <span class="hljs-keyword">AS</span><br><span class="hljs-keyword">SELECT</span> column1, column2, ...<br><span class="hljs-keyword">FROM</span> table_name<br><span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">condition</span>;<br><br><span class="hljs-comment">-- 查询视图</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <br><span class="hljs-keyword">FROM</span> view_name;<br><br><span class="hljs-comment">-- 更新视图</span><br><span class="hljs-keyword">UPDATE</span> view_name <br><span class="hljs-keyword">SET</span> column1 <span class="hljs-operator">=</span> value1, column2 <span class="hljs-operator">=</span> value2 <br><span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">condition</span>;<br><br><span class="hljs-comment">-- 删除视图</span><br><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">VIEW</span> view_name;<br></code></pre></td></tr></table></figure>
<p>需要注意的是, 当基础表中的数据发生变化时, 并不会自动触发视图的更新. 如果要获取最新的数据, 需要重新查询视图. 每次查询视图都会执行视图的查询语句, 根据基础表中的最新数据重新计算结果.</p>
<p>并且, 视图必须满足一定的条件才能被更新:</p>
<ul>
<li>视图必须由单个基本表 (不能包含聚合函数、GROUP BY 子句、DISTINCT 关键字等) 生成.</li>
<li>视图中的列必须是可以被更新的 (即不能是计算字段或表达式).</li>
<li>视图不能使用 <code>JOIN</code>、<code>UNION</code>、<code>GROUP BY</code> 等复杂的查询操作.</li>
</ul>
<p>另外, 当我们更新一个视图时, 实际上是通过更新视图所基于的基本表来实现的. 这意味着如果我们通过更新视图来修改数据, 那么会直接影响到基本表中相应的行.</p>
<h2 id="系统函数">系统函数</h2>
<h3 id="时间函数">时间函数</h3>
<p>MySQL 中时间函数的详细介绍可见<a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/date-and-time-functions.html">官方文档</a>, 下面是常用时间函数的介绍.</p>
<h4 id="当前日期">当前日期</h4>
<p><code>CURDATE()</code> 返回当前日期, <code>CURTIME()</code> 函数返回当前时间, <code>NOW()</code> 函数用于返回当前日期时间.</p>
<p>上述函数的使用示例如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> CURDATE(), <br>       CURTIME(), <br>       NOW();<br><br><span class="hljs-comment">-- 响应的数据</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------------+-----------+---------------------+</span><br><span class="hljs-operator">|</span> CURDATE()  <span class="hljs-operator">|</span> CURTIME() <span class="hljs-operator">|</span> NOW()               <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------------+-----------+---------------------+</span><br><span class="hljs-operator">|</span> <span class="hljs-number">2024</span><span class="hljs-number">-05</span><span class="hljs-number">-25</span> <span class="hljs-operator">|</span> <span class="hljs-number">08</span>:<span class="hljs-number">52</span>:<span class="hljs-number">28</span>  <span class="hljs-operator">|</span> <span class="hljs-number">2024</span><span class="hljs-number">-05</span><span class="hljs-number">-25</span> <span class="hljs-number">08</span>:<span class="hljs-number">52</span>:<span class="hljs-number">28</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------------+-----------+---------------------+</span><br></code></pre></td></tr></table></figure>
<h4 id="日期格式化">日期格式化</h4>
<p><code>DATE_FORMAT(date,fmt)</code>: 按照 <code>fmt</code> 的格式, 对日期 <code>date</code> 进行格式化.</p>
<p>常用的 <code>fmt</code> 格式如下:</p>
<ul>
<li><code>%Y</code>: 年</li>
<li><code>%m</code>: 月</li>
<li><code>%d</code>: 天</li>
<li><code>%H</code>: 小时</li>
<li><code>%i</code>: 分钟</li>
<li><code>%s</code>: 秒</li>
</ul>
<p>上述函数的使用示例如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> DATE_FORMAT(NOW(), <span class="hljs-string">&#x27;%Y/%m/%d %H:%i:%s&#x27;</span>);<br><br><span class="hljs-comment">-- 响应数据</span><br><span class="hljs-operator">+</span><span class="hljs-comment">-----------------------------------------+</span><br><span class="hljs-operator">|</span> DATE_FORMAT(NOW(), <span class="hljs-string">&#x27;%Y/%m/%d %H:%i:%s&#x27;</span>) <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">-----------------------------------------+</span><br><span class="hljs-operator">|</span> <span class="hljs-number">2024</span><span class="hljs-operator">/</span><span class="hljs-number">05</span><span class="hljs-operator">/</span><span class="hljs-number">25</span> <span class="hljs-number">08</span>:<span class="hljs-number">54</span>:<span class="hljs-number">27</span>                     <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">-----------------------------------------+</span><br></code></pre></td></tr></table></figure>
<h4 id="秒-小时转换">秒/小时转换</h4>
<p><code>SEC_TO_TIME(seconds)</code> 函数用于将秒转换为 ‘小时:分:秒’, <code>TIME_TO_SEC(time)</code> 函数用于将 ‘小时:分:秒’ 转换为秒.</p>
<p>上述函数的使用示例如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> SEC_TO_TIME(<span class="hljs-number">3600</span>), <br>       TIME_TO_SEC(<span class="hljs-string">&#x27;1:00:00&#x27;</span>);<br><br><span class="hljs-comment">-- 响应数据</span><br><span class="hljs-operator">+</span><span class="hljs-comment">-------------------+------------------------+</span><br><span class="hljs-operator">|</span> SEC_TO_TIME(<span class="hljs-number">3600</span>) <span class="hljs-operator">|</span> TIME_TO_SEC(<span class="hljs-string">&#x27;1:00:00&#x27;</span>) <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">-------------------+------------------------+</span><br><span class="hljs-operator">|</span> <span class="hljs-number">01</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>          <span class="hljs-operator">|</span>                   <span class="hljs-number">3600</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">-------------------+------------------------+</span><br></code></pre></td></tr></table></figure>
<h4 id="相差天数">相差天数</h4>
<p><code>DATEDIFF(date1, date2)</code> 函数用于返回两个日期间相差的天数.</p>
<p>该函数的使用示例如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> id, <br>       DATEDIFF(NOW(), start_time)<br><span class="hljs-keyword">FROM</span> project;<br><br><span class="hljs-comment">-- 响应数据</span><br><span class="hljs-operator">+</span><span class="hljs-comment">-------------------------+-----------------------------+</span><br><span class="hljs-operator">|</span> id                      <span class="hljs-operator">|</span> DATEDIFF(NOW(), start_time) <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">-------------------------+-----------------------------+</span><br><span class="hljs-operator">|</span> <span class="hljs-number">17149957396939191194</span>    <span class="hljs-operator">|</span>                          <span class="hljs-number">19</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-number">17149957677803825334218</span> <span class="hljs-operator">|</span>                          <span class="hljs-number">19</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-number">17149958265282171675562</span> <span class="hljs-operator">|</span>                          <span class="hljs-number">19</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-number">17149958999614100621095</span> <span class="hljs-operator">|</span>                          <span class="hljs-number">19</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-number">17149959275971865832384</span> <span class="hljs-operator">|</span>                          <span class="hljs-number">19</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-number">1714998249788321310561</span>  <span class="hljs-operator">|</span>                          <span class="hljs-number">19</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-number">17156550446691935346907</span> <span class="hljs-operator">|</span>                          <span class="hljs-number">11</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-number">1715666491514227451556</span>  <span class="hljs-operator">|</span>                          <span class="hljs-number">11</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-number">17160255195963895411960</span> <span class="hljs-operator">|</span>                           <span class="hljs-number">7</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">-------------------------+-----------------------------+</span><br></code></pre></td></tr></table></figure>
<h4 id="日期增减">日期增减</h4>
<p><code>DATE_ADD(date,INTERVAL expr unit)</code> 函数用于对给定的日期增加或减少指定的时间单元:</p>
<ul>
<li>DAY: 天</li>
<li>HOUR: 小时</li>
<li>MINUTES: 分钟</li>
<li>SECOND: 秒</li>
</ul>
<p>该函数的使用示例如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> NOW(),<br>       DATE_ADD(NOW(), <span class="hljs-type">INTERVAL</span> <span class="hljs-number">1</span> <span class="hljs-keyword">YEAR</span>),            <span class="hljs-comment">-- 当前时间加 1 年</span><br>       DATE_ADD(NOW(), <span class="hljs-type">INTERVAL</span> <span class="hljs-number">-1</span> <span class="hljs-keyword">DAY</span>),            <span class="hljs-comment">-- 当前时间减 1 天</span><br>       DATE_ADD(NOW(), <span class="hljs-type">INTERVAL</span> <span class="hljs-string">&#x27;1:30&#x27;</span> HOUR_MINUTE) <span class="hljs-comment">-- 当前时间减 1 小时 30 分</span><br><br><span class="hljs-comment">-- 响应数据</span><br><span class="hljs-operator">+</span><span class="hljs-comment">---------------------+----------------------------------+----------------------------------+----------------------------------------------+</span><br><span class="hljs-operator">|</span> NOW()               <span class="hljs-operator">|</span> DATE_ADD(NOW(), <span class="hljs-type">INTERVAL</span> <span class="hljs-number">1</span> <span class="hljs-keyword">YEAR</span>) <span class="hljs-operator">|</span> DATE_ADD(NOW(), <span class="hljs-type">INTERVAL</span> <span class="hljs-number">-1</span> <span class="hljs-keyword">DAY</span>) <span class="hljs-operator">|</span> DATE_ADD(NOW(), <span class="hljs-type">INTERVAL</span> <span class="hljs-string">&#x27;1:30&#x27;</span> HOUR_MINUTE) <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">---------------------+----------------------------------+----------------------------------+----------------------------------------------+</span><br><span class="hljs-operator">|</span> <span class="hljs-number">2024</span><span class="hljs-number">-05</span><span class="hljs-number">-25</span> <span class="hljs-number">09</span>:<span class="hljs-number">06</span>:<span class="hljs-number">29</span> <span class="hljs-operator">|</span> <span class="hljs-number">2025</span><span class="hljs-number">-05</span><span class="hljs-number">-25</span> <span class="hljs-number">09</span>:<span class="hljs-number">06</span>:<span class="hljs-number">29</span>              <span class="hljs-operator">|</span> <span class="hljs-number">2024</span><span class="hljs-number">-05</span><span class="hljs-number">-24</span> <span class="hljs-number">09</span>:<span class="hljs-number">06</span>:<span class="hljs-number">29</span>              <span class="hljs-operator">|</span> <span class="hljs-number">2024</span><span class="hljs-number">-05</span><span class="hljs-number">-25</span> <span class="hljs-number">10</span>:<span class="hljs-number">36</span>:<span class="hljs-number">29</span>                          <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">---------------------+----------------------------------+----------------------------------+----------------------------------------------+</span><br></code></pre></td></tr></table></figure>
<h4 id="日期提取">日期提取</h4>
<p><code>EXTRACT(unit FROM date)</code> 函数用于返回日期 <code>date</code> 的指定部分.</p>
<p>该函数的使用示例如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 提取出年份</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">EXTRACT</span>(<span class="hljs-keyword">YEAR</span> <span class="hljs-keyword">FROM</span> <span class="hljs-string">&#x27;2024-05-25&#x27;</span>);<br><br><span class="hljs-operator">+</span><span class="hljs-comment">---------------------------------+</span><br><span class="hljs-operator">|</span> <span class="hljs-built_in">EXTRACT</span>(<span class="hljs-keyword">YEAR</span> <span class="hljs-keyword">FROM</span> <span class="hljs-string">&#x27;2024-05-25&#x27;</span>) <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">---------------------------------+</span><br><span class="hljs-operator">|</span>                            <span class="hljs-number">2024</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">---------------------------------+</span><br><br><span class="hljs-comment">-- 提取出 年月</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">EXTRACT</span>(YEAR_MONTH <span class="hljs-keyword">FROM</span> <span class="hljs-string">&#x27;2019-07-02 01:02:03&#x27;</span>);<br><br><span class="hljs-operator">+</span><span class="hljs-comment">------------------------------------------------+</span><br><span class="hljs-operator">|</span> <span class="hljs-built_in">EXTRACT</span>(YEAR_MONTH <span class="hljs-keyword">FROM</span> <span class="hljs-string">&#x27;2019-07-02 01:02:03&#x27;</span>) <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------------------------------------------------+</span><br><span class="hljs-operator">|</span>                                         <span class="hljs-number">201907</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------------------------------------------------+</span><br><br><span class="hljs-comment">-- 提取出分钟</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">EXTRACT</span>(DAY_MINUTE <span class="hljs-keyword">FROM</span> <span class="hljs-string">&#x27;2019-07-02 01:02:03&#x27;</span>);<br><br><span class="hljs-operator">+</span><span class="hljs-comment">------------------------------------------------+</span><br><span class="hljs-operator">|</span> <span class="hljs-built_in">EXTRACT</span>(DAY_MINUTE <span class="hljs-keyword">FROM</span> <span class="hljs-string">&#x27;2019-07-02 01:02:03&#x27;</span>) <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------------------------------------------------+</span><br><span class="hljs-operator">|</span>                                          <span class="hljs-number">20102</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------------------------------------------------+</span><br><br><span class="hljs-comment">-- 提取出毫秒</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">EXTRACT</span>(MICROSECOND <span class="hljs-keyword">FROM</span> <span class="hljs-string">&#x27;2003-01-02 10:30:00.000123&#x27;</span>);<br><br><span class="hljs-operator">+</span><span class="hljs-comment">--------------------------------------------------------+</span><br><span class="hljs-operator">|</span> <span class="hljs-built_in">EXTRACT</span>(MICROSECOND <span class="hljs-keyword">FROM</span> <span class="hljs-string">&#x27;2003-01-02 10:30:00.000123&#x27;</span>) <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">--------------------------------------------------------+</span><br><span class="hljs-operator">|</span>                                                    <span class="hljs-number">123</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">--------------------------------------------------------+</span><br></code></pre></td></tr></table></figure>
<h3 id="字符串函数">字符串函数</h3>
<p>MySQL 中字符串函数的详细介绍可见<a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/string-functions.html">官方文档</a>, 下面是常用字符串函数的介绍.</p>
<h4 id="字符串拼接">字符串拼接</h4>
<p><code>CONCAT(str1,str2,...)</code> 函数用于将多个字符串拼接成一个字符串,  <code>CONCAT_WS(sep,str1,str2..)</code> 函数能够使用指定的分隔符来链接多个字符串.</p>
<p>上述函数的使用示例如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> id,<br>       CONCAT_WS(<span class="hljs-string">&#x27;-&#x27;</span>, name, gender)<br><span class="hljs-keyword">FROM</span> employee;<br><br><span class="hljs-comment">-- 响应数据</span><br><span class="hljs-operator">+</span><span class="hljs-comment">-------------------------+------------------------------+</span><br><span class="hljs-operator">|</span> id                      <span class="hljs-operator">|</span> CONCAT_WS(<span class="hljs-string">&#x27;-&#x27;</span>, name, gender) <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">-------------------------+------------------------------+</span><br><span class="hljs-operator">|</span> <span class="hljs-number">1714974123172173345502</span>  <span class="hljs-operator">|</span> 张三<span class="hljs-operator">-</span>男                      <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-number">17149741681092521189659</span> <span class="hljs-operator">|</span> 李四<span class="hljs-operator">-</span>男                      <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-number">17149742095481024838461</span> <span class="hljs-operator">|</span> 王小花<span class="hljs-operator">-</span>女                    <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-number">17149743247571910234800</span> <span class="hljs-operator">|</span> 赵六<span class="hljs-operator">-</span>男                      <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-number">17149746562851103169968</span> <span class="hljs-operator">|</span> 刘小红<span class="hljs-operator">-</span>女                    <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-number">17149815797243132198325</span> <span class="hljs-operator">|</span> 陈七<span class="hljs-operator">-</span>男                      <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-number">1714982624349520807794</span>  <span class="hljs-operator">|</span> 周小明<span class="hljs-operator">-</span>男                    <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-number">17149826590672879562946</span> <span class="hljs-operator">|</span> 杨小丽<span class="hljs-operator">-</span>女                    <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-number">17149831610353676096239</span> <span class="hljs-operator">|</span> 吴八<span class="hljs-operator">-</span>男                      <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-number">1714983250926899865052</span>  <span class="hljs-operator">|</span> 朱小娟<span class="hljs-operator">-</span>女                    <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-number">17149836666324052788171</span> <span class="hljs-operator">|</span> 韩九<span class="hljs-operator">-</span>男                      <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-number">17149837188451120575386</span> <span class="hljs-operator">|</span> 尤小明<span class="hljs-operator">-</span>男                    <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-number">17149837912752705328407</span> <span class="hljs-operator">|</span> 刘九妹<span class="hljs-operator">-</span>女                    <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-number">17149981322701211190081</span> <span class="hljs-operator">|</span> 郑小兰<span class="hljs-operator">-</span>女                    <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> admin0000               <span class="hljs-operator">|</span> 管理员<span class="hljs-operator">-</span>男                    <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">-------------------------+------------------------------+</span><br></code></pre></td></tr></table></figure>
<h4 id="字符串长度">字符串长度</h4>
<p><code>CHAR_LENGTH(str)</code> 函数用于返回字符串 <code>str</code> 的字符数, <code>LENGTH(str)</code> 函数用于返回字符串 <code>str</code> 的字节数.</p>
<p>上述函数的使用示例如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> LENGTH(<span class="hljs-string">&#x27;word hello&#x27;</span>),<br>       <span class="hljs-keyword">CHAR_LENGTH</span>(<span class="hljs-string">&#x27;word hello&#x27;</span>),<br>       LENGTH(<span class="hljs-string">&#x27;my 数据库教程&#x27;</span>),<br>       <span class="hljs-keyword">CHAR_LENGTH</span>(<span class="hljs-string">&#x27;my 数据库教程&#x27;</span>);<br><br><span class="hljs-comment">-- 响应数据</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----------------------+---------------------------+-------------------------+------------------------------+</span><br><span class="hljs-operator">|</span> LENGTH(<span class="hljs-string">&#x27;word hello&#x27;</span>) <span class="hljs-operator">|</span> <span class="hljs-keyword">CHAR_LENGTH</span>(<span class="hljs-string">&#x27;word hello&#x27;</span>) <span class="hljs-operator">|</span> LENGTH(<span class="hljs-string">&#x27;my 数据库教程&#x27;</span>) <span class="hljs-operator">|</span> <span class="hljs-keyword">CHAR_LENGTH</span>(<span class="hljs-string">&#x27;my 数据库教程&#x27;</span>) <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----------------------+---------------------------+-------------------------+------------------------------+</span><br><span class="hljs-operator">|</span>                   <span class="hljs-number">10</span> <span class="hljs-operator">|</span>                        <span class="hljs-number">10</span> <span class="hljs-operator">|</span>                      <span class="hljs-number">13</span> <span class="hljs-operator">|</span>                            <span class="hljs-number">8</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----------------------+---------------------------+-------------------------+------------------------------+</span><br></code></pre></td></tr></table></figure>
<h4 id="数字格式化">数字格式化</h4>
<p><code>FORMAT(number, decimals)</code> 函数用于将数字格式化为带有指定小数位数、千位分隔符和小数点的<strong>字符串</strong>形式, 其中:</p>
<ul>
<li><code>number</code> 是要格式化的数字</li>
<li><code>decimals</code> 是要显示的小数位数</li>
</ul>
<p>该函数的使用示例如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sql"><br><span class="hljs-keyword">SELECT</span> FORMAT(<span class="hljs-number">123456.789</span>, <span class="hljs-number">4</span>);<br><br><span class="hljs-comment">-- 响应数据</span><br><span class="hljs-operator">+</span><span class="hljs-comment">-----------------------+</span><br><span class="hljs-operator">|</span> FORMAT(<span class="hljs-number">123456.789</span>, <span class="hljs-number">4</span>) <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">-----------------------+</span><br><span class="hljs-operator">|</span> <span class="hljs-number">123</span>,<span class="hljs-number">456.7890</span>          <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">-----------------------+</span><br></code></pre></td></tr></table></figure>
<h4 id="字符串截取">字符串截取</h4>
<p><code>LEFT(str, length)</code> 函数用于从字符串的左边开始提取指定长度的字符, <code>RIGHT(str, length)</code> 函数用于从字符串的右边开始提取指定长度的字符.</p>
<p>上述函数的使用示例如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">LEFT</span>(<span class="hljs-string">&#x27;www.baidu.com&#x27;</span>, <span class="hljs-number">3</span>),<br>       <span class="hljs-keyword">RIGHT</span>(<span class="hljs-string">&#x27;www.baidu.com&#x27;</span>, <span class="hljs-number">3</span>);<br><br><span class="hljs-comment">-- 响应数据</span><br><span class="hljs-operator">+</span><span class="hljs-comment">--------------------------+---------------------------+</span><br><span class="hljs-operator">|</span> <span class="hljs-keyword">LEFT</span>(<span class="hljs-string">&#x27;www.baidu.com&#x27;</span>, <span class="hljs-number">3</span>) <span class="hljs-operator">|</span> <span class="hljs-keyword">RIGHT</span>(<span class="hljs-string">&#x27;www.baidu.com&#x27;</span>, <span class="hljs-number">3</span>) <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">--------------------------+---------------------------+</span><br><span class="hljs-operator">|</span> www                      <span class="hljs-operator">|</span> com                       <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">--------------------------+---------------------------+</span><br></code></pre></td></tr></table></figure>
<p><code>SUBSTRING(str,pos[,len])</code> 用于从字符串中提取子字符串, 其中:</p>
<ul>
<li><code>str</code> 是要提取子字符串的源字符串</li>
<li><code>start</code> 是提取开始的位置 (从 1 开始计数)</li>
<li><code>length</code> 是要提取的字符数</li>
</ul>
<p>该函数的使用示例如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">SUBSTRING</span>(<span class="hljs-string">&#x27;www.baidu.com&#x27;</span>, <span class="hljs-number">1</span>),<br>       <span class="hljs-built_in">SUBSTRING</span>(<span class="hljs-string">&#x27;www.baidu.com&#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>)<br><br><span class="hljs-comment">-- 响应数据</span><br><span class="hljs-operator">+</span><span class="hljs-comment">-------------------------------+----------------------------------+</span><br><span class="hljs-operator">|</span> <span class="hljs-built_in">SUBSTRING</span>(<span class="hljs-string">&#x27;www.baidu.com&#x27;</span>, <span class="hljs-number">1</span>) <span class="hljs-operator">|</span> <span class="hljs-built_in">SUBSTRING</span>(<span class="hljs-string">&#x27;www.baidu.com&#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>) <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">-------------------------------+----------------------------------+</span><br><span class="hljs-operator">|</span> www.baidu.com                 <span class="hljs-operator">|</span> www                              <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">-------------------------------+----------------------------------+</span><br></code></pre></td></tr></table></figure>
<p><code>SUBSTRING_INDEX(str,delim,count)</code> 函数用于从字符串中提取子字符串, 基于指定的分隔符. 它返回一个子字符串, 该子字符串包含在原始字符串中指定分隔符的左侧或右侧的所有内容. 其中:</p>
<ul>
<li><code>str</code> 是要处理的字符串</li>
<li><code>delim</code> 是用作分隔符的字符串</li>
<li><code>count</code> 指定从左侧或右侧提取的子字符串数量. 如果 <code>count</code> 为正数, 则从左往右取; 如果为负数, 则从右往左取.</li>
</ul>
<p>该函数的使用示例如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> SUBSTRING_INDEX(<span class="hljs-string">&#x27;www.baidu.com&#x27;</span>, <span class="hljs-string">&#x27;.&#x27;</span>, <span class="hljs-number">2</span>),<br>       SUBSTRING_INDEX(<span class="hljs-string">&#x27;www.baidu.com&#x27;</span>, <span class="hljs-string">&#x27;.&#x27;</span>, <span class="hljs-operator">-</span> <span class="hljs-number">2</span>);<br><br><span class="hljs-comment">-- 响应数据</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------------------------------------------+--------------------------------------------+</span><br><span class="hljs-operator">|</span> SUBSTRING_INDEX(<span class="hljs-string">&#x27;www.baidu.com&#x27;</span>, <span class="hljs-string">&#x27;.&#x27;</span>, <span class="hljs-number">2</span>) <span class="hljs-operator">|</span> SUBSTRING_INDEX(<span class="hljs-string">&#x27;www.baidu.com&#x27;</span>, <span class="hljs-string">&#x27;.&#x27;</span>, <span class="hljs-operator">-</span> <span class="hljs-number">2</span>) <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------------------------------------------+--------------------------------------------+</span><br><span class="hljs-operator">|</span> www.baidu                                <span class="hljs-operator">|</span> baidu.com                                  <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------------------------------------------+--------------------------------------------+</span><br></code></pre></td></tr></table></figure>
<h4 id="子串定位">子串定位</h4>
<p><code>LOCATE(substr,str[, pos])</code> 函数用于在字符串中查找子字符串, 并返回子字符串第一次出现的位置. 其中:</p>
<ul>
<li><code>substr</code> 是要查找的子字符串</li>
<li><code>str</code> 是要在其中查找子字符串的源字符串</li>
<li><code>pos</code> 是可选参数, 指定开始搜索的位置. 如果省略, 则默认从字符串的第一个字符开始搜索.</li>
</ul>
<p>该函数的使用示例如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> LOCATE(<span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;www.baidu.com&#x27;</span>),<br>       LOCATE(<span class="hljs-string">&#x27;w&#x27;</span>, <span class="hljs-string">&#x27;www.baidu.com&#x27;</span>);<br><br><span class="hljs-comment">-- 响应数据</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------------------------------+------------------------------+</span><br><span class="hljs-operator">|</span> LOCATE(<span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;www.baidu.com&#x27;</span>) <span class="hljs-operator">|</span> LOCATE(<span class="hljs-string">&#x27;w&#x27;</span>, <span class="hljs-string">&#x27;www.baidu.com&#x27;</span>) <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------------------------------+------------------------------+</span><br><span class="hljs-operator">|</span>                            <span class="hljs-number">5</span> <span class="hljs-operator">|</span>                            <span class="hljs-number">1</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------------------------------+------------------------------+</span><br></code></pre></td></tr></table></figure>
<h4 id="双端删除字符">双端删除字符</h4>
<p><code>TRIM([&#123;BOTH | LEADING | TRAILING&#125; [remstr] FROM] str)</code> 函数用于从字符串的开头和结尾删除指定字符 (或空格). 其中:</p>
<ul>
<li><code>&#123;BOTH | LEADING | TRAILING&#125;</code> 用于指定删除字符的位置. <code>BOTH</code> 表示从开头和结尾删除, <code>LEADING</code> 表示从开头删除, <code>TRAILING</code> 表示从结尾删除. 如果不指定位置, 默认为 <code>BOTH</code></li>
<li><code>remstr</code> 是要删除的字符 (或空格). 如果省略, 则默认删除空格.</li>
</ul>
<p>该函数通常用于删除字符串两端的空格. 该函数的使用示例如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">TRIM</span>(<span class="hljs-string">&#x27;    mrcode    &#x27;</span>);<br><br><span class="hljs-operator">+</span><span class="hljs-comment">------------------------+</span><br><span class="hljs-operator">|</span> <span class="hljs-built_in">TRIM</span>(<span class="hljs-string">&#x27;    mrcode    &#x27;</span>) <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------------------------+</span><br><span class="hljs-operator">|</span> mrcode                 <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------------------------+</span><br><br><br><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">TRIM</span>(<span class="hljs-string">&#x27;x&#x27;</span> <span class="hljs-keyword">FROM</span> <span class="hljs-string">&#x27;xxmrcodexx&#x27;</span>);<br><br><span class="hljs-operator">+</span><span class="hljs-comment">-----------------------------+</span><br><span class="hljs-operator">|</span> <span class="hljs-built_in">TRIM</span>(<span class="hljs-string">&#x27;x&#x27;</span> <span class="hljs-keyword">FROM</span> <span class="hljs-string">&#x27;xxmrcodexx&#x27;</span>) <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">-----------------------------+</span><br><span class="hljs-operator">|</span> mrcode                      <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">-----------------------------+</span><br></code></pre></td></tr></table></figure>
<h2 id="数据流控制">数据流控制</h2>
<p><code>CASE</code> 表达式是一种条件语句, 允许根据特定条件返回不同的值. <code>CASE</code> 表达式的基本语法如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CASE</span> column_name<br>    <span class="hljs-keyword">WHEN</span> condition1 <span class="hljs-keyword">THEN</span> result1<br>    <span class="hljs-keyword">WHEN</span> condition2 <span class="hljs-keyword">THEN</span> result2<br>    ...<br>    <span class="hljs-keyword">ELSE</span> default_result<br><span class="hljs-keyword">END</span><br></code></pre></td></tr></table></figure>
<p><code>CASE</code> 表达式从上到下依次检查条件, 一旦某个条件满足, 就返回相应的结果并结束. 如果没有任何条件满足, 则返回默认值.</p>
<p><code>CASE</code> 控制流的使用示例如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> name,<br>       <span class="hljs-keyword">CASE</span> gender<br>           <span class="hljs-keyword">WHEN</span> <span class="hljs-string">&#x27;男&#x27;</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">0</span><br>           <span class="hljs-keyword">WHEN</span> <span class="hljs-string">&#x27;女&#x27;</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span><br>           <span class="hljs-keyword">ELSE</span> <span class="hljs-number">-1</span><br>       <span class="hljs-keyword">END</span> <span class="hljs-keyword">AS</span> gender<br><span class="hljs-keyword">FROM</span> employee;<br><br><span class="hljs-comment">-- 响应数据</span><br><span class="hljs-operator">+</span><span class="hljs-comment">--------+--------+</span><br><span class="hljs-operator">|</span> name   <span class="hljs-operator">|</span> gender <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">--------+--------+</span><br><span class="hljs-operator">|</span> 张三   <span class="hljs-operator">|</span>      <span class="hljs-number">0</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> 李四   <span class="hljs-operator">|</span>      <span class="hljs-number">0</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> 王小花 <span class="hljs-operator">|</span>      <span class="hljs-number">1</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> 赵六   <span class="hljs-operator">|</span>      <span class="hljs-number">0</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> 刘小红 <span class="hljs-operator">|</span>      <span class="hljs-number">1</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> 陈七   <span class="hljs-operator">|</span>      <span class="hljs-number">0</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> 周小明 <span class="hljs-operator">|</span>      <span class="hljs-number">0</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> 杨小丽 <span class="hljs-operator">|</span>      <span class="hljs-number">1</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> 吴八   <span class="hljs-operator">|</span>      <span class="hljs-number">0</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> 朱小娟 <span class="hljs-operator">|</span>      <span class="hljs-number">1</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> 韩九   <span class="hljs-operator">|</span>      <span class="hljs-number">0</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> 尤小明 <span class="hljs-operator">|</span>      <span class="hljs-number">0</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> 刘九妹 <span class="hljs-operator">|</span>      <span class="hljs-number">1</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> 郑小兰 <span class="hljs-operator">|</span>      <span class="hljs-number">1</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> 管理员 <span class="hljs-operator">|</span>      <span class="hljs-number">0</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">--------+--------+</span><br></code></pre></td></tr></table></figure>
<h2 id="CTE-公用表表达式">CTE (公用表表达式)</h2>
<p>CTE 是一种临时的命名查询结果集, 它在 SQL 语句中使用 <code>WITH</code> 子句定义. CTE 可以被视为一个临时的、可重用的视图, 它允许我们在查询中定义复杂的子查询, 并且可以在查询中多次引用.</p>
<p>它的基本语法如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">WITH</span> cte_name [(col_name [, col_name] ...)] <span class="hljs-keyword">AS</span> (<br>   CTE_query_definition <span class="hljs-comment">-- 定义 CTE 的查询</span><br>)<br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> cte_name; <span class="hljs-comment">-- 使用 CTE 的查询</span><br></code></pre></td></tr></table></figure>
<p>例如:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">WITH</span> cte_employee <span class="hljs-keyword">AS</span> (<br>    <span class="hljs-keyword">SELECT</span> name, gender<br>    <span class="hljs-keyword">FROM</span> employee<br>)<br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> cte_employee;<br><br><span class="hljs-operator">+</span><span class="hljs-comment">--------+--------+</span><br><span class="hljs-operator">|</span> name   <span class="hljs-operator">|</span> gender <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">--------+--------+</span><br><span class="hljs-operator">|</span> 张三   <span class="hljs-operator">|</span> 男     <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> 李四   <span class="hljs-operator">|</span> 男     <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> 王小花 <span class="hljs-operator">|</span> 女     <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> 赵六   <span class="hljs-operator">|</span> 男     <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> 刘小红 <span class="hljs-operator">|</span> 女     <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> 陈七   <span class="hljs-operator">|</span> 男     <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> 周小明 <span class="hljs-operator">|</span> 男     <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> 杨小丽 <span class="hljs-operator">|</span> 女     <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> 吴八   <span class="hljs-operator">|</span> 男     <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> 朱小娟 <span class="hljs-operator">|</span> 女     <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> 韩九   <span class="hljs-operator">|</span> 男     <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> 尤小明 <span class="hljs-operator">|</span> 男     <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> 刘九妹 <span class="hljs-operator">|</span> 女     <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> 郑小兰 <span class="hljs-operator">|</span> 女     <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> 管理员 <span class="hljs-operator">|</span> 男     <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">--------+--------+</span><br></code></pre></td></tr></table></figure>
<h2 id="窗口函数">窗口函数</h2>
<p>窗口函数, 也被称为 OLAP 函数, 主要用于对数据库数据进行实时分析处理, 只在 <code>SELECT</code> 中使用.</p>
<p>窗口函数的使用语法如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <br>    column_name(s),<br>    window_function (column_name) <span class="hljs-keyword">OVER</span> (<br>        [<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> column_name(s)]<br>        [<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> column_name(s)]<br>        [<span class="hljs-keyword">ROWS</span> <span class="hljs-operator">|</span> <span class="hljs-keyword">RANGE</span> frame_definition]<br>    )<br><span class="hljs-keyword">FROM</span> table_name;<br></code></pre></td></tr></table></figure>
<ul>
<li><code>PARTITION BY</code> 用于定义窗口内的分组, 和 <code>GROUP BY</code> 的区别是 <code>PARTITION BY</code> 不会减少原表的行数.</li>
<li><code>ORDER BY</code> 用于定义窗口内的排序.</li>
<li><code>ROWS | RANGE</code> 用于定义窗口的范围, 它可以是从开始到当前行、从当前行到结束, 或是围绕当前行的一个范围.</li>
</ul>
<p>而 <code>window_function</code> 包含以下两种函数:</p>
<ul>
<li>专用窗口函数, 如 <code>rank</code>, <code>dense_rank</code>, <code>row_number</code> 等.</li>
<li>聚合函数, 如 <code>sum</code>, <code>avg</code>, <code>count</code>, <code>max</code>, <code>min</code> 等.</li>
</ul>
<p>专用窗口函数可以用来实现组内排序. 例如, 如果我想要根据性别对员工分组后按年龄排序, 可以使用以下 SQL 语句:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> id,<br>       name,<br>       gender,<br>       age,<br>       <span class="hljs-built_in">rank</span>() <span class="hljs-keyword">OVER</span> (<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> gender<br>                    <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> age <span class="hljs-keyword">DESC</span>) <span class="hljs-keyword">AS</span> ranking<br><span class="hljs-keyword">FROM</span> employee;<br><br><span class="hljs-comment">-- 响应数据</span><br><span class="hljs-operator">+</span><span class="hljs-comment">-------------------------+--------+--------+-----+---------+</span><br><span class="hljs-operator">|</span> id                      <span class="hljs-operator">|</span> name   <span class="hljs-operator">|</span> gender <span class="hljs-operator">|</span> age <span class="hljs-operator">|</span> ranking <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">-------------------------+--------+--------+-----+---------+</span><br><span class="hljs-operator">|</span> <span class="hljs-number">17149743247571910234800</span> <span class="hljs-operator">|</span> 赵六   <span class="hljs-operator">|</span> 男     <span class="hljs-operator">|</span>  <span class="hljs-number">40</span> <span class="hljs-operator">|</span>       <span class="hljs-number">1</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-number">17149741681092521189659</span> <span class="hljs-operator">|</span> 李四   <span class="hljs-operator">|</span> 男     <span class="hljs-operator">|</span>  <span class="hljs-number">36</span> <span class="hljs-operator">|</span>       <span class="hljs-number">2</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-number">17149831610353676096239</span> <span class="hljs-operator">|</span> 吴八   <span class="hljs-operator">|</span> 男     <span class="hljs-operator">|</span>  <span class="hljs-number">33</span> <span class="hljs-operator">|</span>       <span class="hljs-number">3</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-number">17149836666324052788171</span> <span class="hljs-operator">|</span> 韩九   <span class="hljs-operator">|</span> 男     <span class="hljs-operator">|</span>  <span class="hljs-number">31</span> <span class="hljs-operator">|</span>       <span class="hljs-number">4</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-number">17149815797243132198325</span> <span class="hljs-operator">|</span> 陈七   <span class="hljs-operator">|</span> 男     <span class="hljs-operator">|</span>  <span class="hljs-number">30</span> <span class="hljs-operator">|</span>       <span class="hljs-number">5</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-number">1714974123172173345502</span>  <span class="hljs-operator">|</span> 张三   <span class="hljs-operator">|</span> 男     <span class="hljs-operator">|</span>  <span class="hljs-number">28</span> <span class="hljs-operator">|</span>       <span class="hljs-number">6</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-number">17149837188451120575386</span> <span class="hljs-operator">|</span> 尤小明 <span class="hljs-operator">|</span> 男     <span class="hljs-operator">|</span>  <span class="hljs-number">26</span> <span class="hljs-operator">|</span>       <span class="hljs-number">7</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> admin0000               <span class="hljs-operator">|</span> 管理员 <span class="hljs-operator">|</span> 男     <span class="hljs-operator">|</span>  <span class="hljs-number">25</span> <span class="hljs-operator">|</span>       <span class="hljs-number">8</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-number">1714982624349520807794</span>  <span class="hljs-operator">|</span> 周小明 <span class="hljs-operator">|</span> 男     <span class="hljs-operator">|</span>  <span class="hljs-number">23</span> <span class="hljs-operator">|</span>       <span class="hljs-number">9</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-number">17149837912752705328407</span> <span class="hljs-operator">|</span> 刘九妹 <span class="hljs-operator">|</span> 女     <span class="hljs-operator">|</span>  <span class="hljs-number">32</span> <span class="hljs-operator">|</span>       <span class="hljs-number">1</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-number">1714983250926899865052</span>  <span class="hljs-operator">|</span> 朱小娟 <span class="hljs-operator">|</span> 女     <span class="hljs-operator">|</span>  <span class="hljs-number">29</span> <span class="hljs-operator">|</span>       <span class="hljs-number">2</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-number">17149826590672879562946</span> <span class="hljs-operator">|</span> 杨小丽 <span class="hljs-operator">|</span> 女     <span class="hljs-operator">|</span>  <span class="hljs-number">28</span> <span class="hljs-operator">|</span>       <span class="hljs-number">3</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-number">17149981322701211190081</span> <span class="hljs-operator">|</span> 郑小兰 <span class="hljs-operator">|</span> 女     <span class="hljs-operator">|</span>  <span class="hljs-number">27</span> <span class="hljs-operator">|</span>       <span class="hljs-number">4</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-number">17149746562851103169968</span> <span class="hljs-operator">|</span> 刘小红 <span class="hljs-operator">|</span> 女     <span class="hljs-operator">|</span>  <span class="hljs-number">25</span> <span class="hljs-operator">|</span>       <span class="hljs-number">5</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-number">17149742095481024838461</span> <span class="hljs-operator">|</span> 王小花 <span class="hljs-operator">|</span> 女     <span class="hljs-operator">|</span>  <span class="hljs-number">24</span> <span class="hljs-operator">|</span>       <span class="hljs-number">6</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">-------------------------+--------+--------+-----+---------+</span><br></code></pre></td></tr></table></figure>
<p>而 <code>rank()</code>、<code>dense_rank()</code> 和 <code>row_number</code> 的区别可以看以下示例:<br>
<img src="/img/Pictures/20240525101423.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>聚合函数作为窗口函数时的使用方法和上面的一致. 只不过使用聚合函数时, 每条记录得到的是对自身记录、以及位于自身记录以上的数据进行计算的结果. 这样可以在每一行的数据里直观的看到, 截止到本行数据, 统计数据是多少. 同时也可以看到每一行数据对整体统计数据的影响.</p>
<h2 id="Reference">Reference</h2>
<section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span>给程序员的 MySQL 8.0 必知必会: <a target="_blank" rel="noopener" href="https://zq99299.github.io/mysql-tutorial/imooc-mysql8/01.html">https://zq99299.github.io/mysql-tutorial/imooc-mysql8/01.html</a>
<a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span>通俗易懂的学会：SQL窗口函数: <a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/92654574">https://zhuanlan.zhihu.com/p/92654574</a>
<a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:3" class="footnote-text"><span>MySQL表的七种连接方式: <a target="_blank" rel="noopener" href="https://blog.csdn.net/laodanqiu/article/details/131233741">https://blog.csdn.net/laodanqiu/article/details/131233741</a>
<a href="#fnref:3" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>
                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E7%AC%94%E8%AE%B0/" class="category-chain-item">笔记</a>
  
  
    <span>></span>
    
  <a href="/categories/%E7%AC%94%E8%AE%B0/%E6%95%B0%E6%8D%AE%E5%BA%93/" class="category-chain-item">数据库</a>
  
  

  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" class="print-no-link">#数据库</a>
      
        <a href="/tags/MySQL/" class="print-no-link">#MySQL</a>
      
    </div>
  
</div>


              

              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2024/07/04/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/%E5%9C%B0%E5%9D%80%E6%97%8F%E4%B8%8E%E6%95%B0%E6%8D%AE%E5%BA%8F%E5%88%97/" title="地址族与数据序列">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">地址族与数据序列</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/07/04/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%AD%97%E5%85%B8%E6%A0%91/" title="字典树">
                        <span class="hidden-mobile">字典树</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
